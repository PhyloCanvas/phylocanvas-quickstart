!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):"object"==typeof exports?exports.PhyloCanvas=t():e.PhyloCanvas=t()}(this,function(){return function(e){function t(n){if(a[n])return a[n].exports;var r=a[n]={exports:{},id:n,loaded:!1};return e[n].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var a={};return t.m=e,t.c=a,t.p="",t(0)}([function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(1),i=n(r),s=a(2),o=n(s),l=a(3),h=n(l),c=a(4),d=n(c);i["default"].plugin(o["default"]),i["default"].plugin(h["default"]),i["default"].plugin(d["default"]),t["default"]=i["default"],e.exports=t["default"]},function(e,t,a){"use strict";!function(t,a){e.exports=a()}(void 0,function(){return function(e){function t(n){if(a[n])return a[n].exports;var r=a[n]={exports:{},id:n,loaded:!1};return e[n].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var a={};return t.m=e,t.c=a,t.p="/dist/",t(0)}([function(e,t,a){function n(e){return e&&e.__esModule?e:{"default":e}}function r(e,t,a){var n=e[t]?e:e.prototype,r=n[t];n[t]=function(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];return a.call(this,r,t)}}function i(e){e.call(this,r)}function s(e){var t=void 0===arguments[1]?{}:arguments[1];return new l["default"](e,t)}Object.defineProperty(t,"__esModule",{value:!0});var o=a(2),l=n(o),h=a(3),c=n(h),d=a(8),u=n(d),f=a(1),v=n(f),p=a(11),g=n(p),y=a(7),b=n(y);t.Tree=l["default"],t.Branch=c["default"],t.ContextMenu=u["default"],t.Parser=v["default"],t.treeTypes=g["default"],t.nodeRenderers=b["default"],t["default"]={plugin:i,createTree:s}},function(e,t,a){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),i=function(){function e(t){var a=t.format,r=t.parseFn,i=t.fileExtension,s=t.validator;n(this,e),this.format=a,this.parseFn=r,this.fileExtension=i,this.validator=s}return r(e,[{key:"parse",value:function(e,t){var a=e.formatString,n=e.root,r=e.options,i=void 0===r?{validate:!0}:r;return a.match(this.validator)||i.validate===!1?this.parseFn({string:a,root:n,options:i},t):t(new Error('Format string does not validate as "'+this.format+'"'))}}]),e}();t["default"]=i,e.exports=t["default"]},function(e,t,a){function n(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(Array.isArray(e)){for(var t=0,a=Array(e.length);t<e.length;t++)a[t]=e[t];return a}return Array.from(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),o=a(3),l=n(o),h=a(8),c=n(h),d=a(9),u=n(d),f=a(10),v=n(f),p=a(11),g=n(p),y=a(5),b=a(6),m=a(29),x=a(30),w=n(x),k=function(){function e(t){var a=void 0===arguments[1]?{}:arguments[1];i(this,e),this.canvasEl="string"==typeof t?document.getElementById(t):t,y.addClass(this.canvasEl,"pc-container"),this.branches={},this.leaves=[],this.root=!1,this.stringRepresentation="",this.lastId=0,this.backColour=!1,this.originalTree={},"static"===window.getComputedStyle(this.canvasEl).position&&(this.canvasEl.style.position="relative"),this.canvasEl.style.boxSizing="border-box";var n=document.createElement("canvas");n.id=(t.id||"")+"__canvas",n.className="phylocanvas",n.style.position="relative",n.style.backgroundColor="#FFFFFF",n.height=t.offsetHeight||400,n.width=t.offsetWidth||400,n.style.zIndex="1",this.canvasEl.appendChild(n),this.contextMenu=new c["default"](this,a.contextMenu),this.defaultCollapsedOptions={},this.defaultCollapsed=!1,void 0!==a.defaultCollapsed&&a.defaultCollapsed.min&&a.defaultCollapsed.max&&(this.defaultCollapsedOptions=a.defaultCollapsed,this.defaultCollapsed=!0),this.tooltip=new u["default"](this),this.drawn=!1,this.selectedNodes=[],this.zoom=1,this.pickedup=!1,this.dragging=!1,this.startx=null,this.starty=null,this.pickedup=!1,this.baseNodeSize=1,this.curx=null,this.cury=null,this.origx=null,this.origy=null,this.canvas=n.getContext("2d"),this.canvas.canvas.onselectstart=function(){return!1},this.canvas.fillStyle="#000000",this.canvas.strokeStyle="#000000",this.canvas.save(),this.offsetx=this.canvas.canvas.width/2,this.offsety=this.canvas.canvas.height/2,this.selectedColour="rgba(49,151,245,1)",this.highlightColour="rgba(49,151,245,1)",this.highlightWidth=5,this.selectedNodeSizeIncrease=0,this.branchColour="rgba(0,0,0,1)",this.branchScalar=1,this.hoverLabel=!1,this.internalNodesSelectable=!0,this.showLabels=!0,this.showBootstraps=!1,this.setTreeType("radial"),this.maxBranchLength=0,this.lineWidth=1,this.textSize=7,this.font="sans-serif",this.unselectOnClickAway=!0,this.rightClickZoom=!0,this.useNavigator&&(this.navigator=new v["default"](this)),this.resizeToContainer(),this.addListener("contextmenu",this.clicked.bind(this)),this.addListener("click",this.clicked.bind(this)),this.addListener("mousedown",this.pickup.bind(this)),this.addListener("mouseup",this.drop.bind(this)),this.addListener("mouseout",this.drop.bind(this)),b.addEvent(this.canvas.canvas,"mousemove",this.drag.bind(this)),b.addEvent(this.canvas.canvas,"mousewheel",this.scroll.bind(this)),b.addEvent(this.canvas.canvas,"DOMMouseScroll",this.scroll.bind(this)),b.addEvent(window,"resize",function(){this.resizeToContainer(),this.draw()}.bind(this)),this.alignLabels=!1,this.farthestNodeFromRootX=0,this.farthestNodeFromRootY=0,this.colour1="rgba(206,16,16,1)",this.colour0="#ccc",this.maxLabelLength={}}return s(e,[{key:"setInitialCollapsedBranches",value:function(){var e,t,a=void 0===arguments[0]?this.root:arguments[0];if(e=a.getChildIds(),e&&e.length>this.defaultCollapsedOptions.min&&e.length<this.defaultCollapsedOptions.max)return void(a.collapsed=!0);for(t=0;t<a.children.length;t++)this.setInitialCollapsedBranches(a.children[t])}},{key:"clicked",value:function(e){var t,a;if(0===e.button){var n;if(a=[],this.dragging)return void(this.dragging=!1);if(!this.root)return!1;t=(n=this.root).clicked.apply(n,r(m.translateClick(e.clientX,e.clientY,this))),t?(this.root.setSelected(!1,!0),(this.internalNodesSelectable||t.leaf)&&(t.setSelected(!0,!0),a=t.getChildIds()),this.draw()):this.unselectOnClickAway&&this.contextMenu.closed&&!this.dragging&&(this.root.setSelected(!1,!0),this.draw()),this.pickedup||(this.dragging=!1),this.nodesSelected(a)}else if(2===e.button){var i;e.preventDefault(),t=(i=this.root).clicked.apply(i,r(m.translateClick(e.clientX,e.clientY,this))),this.contextMenu.open(e.clientX,e.clientY,t),this.contextMenu.closed=!1,this.tooltip.close()}}},{key:"dblclicked",value:function(e){var t;if(!this.root)return!1;var a=(t=this.root).clicked.apply(t,r(m.translateClick(1*e.clientX,1*e.clientY,this)));a&&(a.setSelected(!1,!0),a.toggleCollapsed()),this.pickedup||(this.dragging=!1),this.draw()}},{key:"displayLabels",value:function(){this.showLabels=!0,this.draw()}},{key:"drag",value:function(e){var t=m.getPixelRatio(this.canvas);if(!this.drawn)return!1;if(this.pickedup){var a=(e.clientX-this.startx)*t,n=(e.clientY-this.starty)*t;Math.abs(a)+Math.abs(n)>5&&(this.dragging=!0,this.offsetx=this.origx+a,this.offsety=this.origy+n,this.draw())}else if(this.zoomPickedUp)this.d=(this.starty-e.clientY)/100,this.setZoom(this.origZoom+this.d),this.draw();else{var i,s=e,o=(i=this.root).clicked.apply(i,r(m.translateClick(1*s.clientX,1*s.clientY,this)));o&&(this.internalNodesSelectable||o.leaf)?(this.root.setHighlighted(!1),o.setHighlighted(!0),o.leaf||o.hasCollapsedAncestor()||!this.contextMenu.closed||this.tooltip.open(s.clientX,s.clientY,o)):(this.tooltip.close(),this.contextMenu.close(),this.root.setHighlighted(!1)),this.draw()}}},{key:"draw",value:function(e){return this.selectedNodes=[],0===this.maxBranchLength?void this.loadError(new Error("All branches in the tree are identical.")):(this.canvas.restore(),this.canvas.clearRect(0,0,this.canvas.canvas.width,this.canvas.canvas.height),this.canvas.lineCap="round",this.canvas.lineJoin="round",this.canvas.strokeStyle=this.branchColour,this.canvas.save(),this.canvas.translate(this.canvas.canvas.width/2/m.getBackingStorePixelRatio(this.canvas),this.canvas.canvas.height/2/m.getBackingStorePixelRatio(this.canvas)),(!this.drawn||e)&&(this.prerenderer.run(this),e||this.fitInPanel()),this.canvas.lineWidth=this.lineWidth/this.zoom,this.canvas.translate(this.offsetx,this.offsety),this.canvas.scale(this.zoom,this.zoom),this.branchRenderer.render(this,this.root),this.defaultCollapsed=!1,void(this.drawn=!0))}},{key:"drop",value:function(){return this.drawn?(this.pickedup=!1,void(this.zoomPickedUp=!1)):!1}},{key:"findBranch",value:function(e){this.root.setSelected(!1,!0);for(var t=0;t<this.leaves.length;t++)this.leaves[t].id.match(new RegExp(e,"i"))&&this.leaves[t].setSelected(!0,!0);this.draw()}},{key:"clearSelect",value:function(){this.root.setSelected(!1,!0),this.draw()}},{key:"generateBranchId",value:function(){return"pcn"+this.lastId++}},{key:"getPngUrl",value:function(){return this.canvas.canvas.toDataURL()}},{key:"hideLabels",value:function(){this.showLabels=!1,this.draw()}},{key:"load",value:function(e,t,a){void 0===t&&(t={});var n=t,r=a;if("function"==typeof t&&(r=t,n={}),r&&(n.callback=r),n.format)return void this.build(e,w["default"][n.format],n);var i=!0,s=!1,o=void 0;try{for(var l,h=Object.keys(w["default"])[Symbol.iterator]();!(i=(l=h.next()).done);i=!0){var c=l.value,d=w["default"][c];if(e.match(d.fileExtension)||e.match(d.validator))return void this.build(e,d,n)}}catch(u){s=!0,o=u}finally{try{!i&&h["return"]&&h["return"]()}finally{if(s)throw o}}var f=new Error("String not recognised as a file or a parseable format string");r&&r(f),this.loadError(f)}},{key:"saveOriginalTree",value:function(){this.originalTree.branches=this.branches,this.originalTree.leaves=this.leaves,this.originalTree.root=this.root,this.originalTree.branchLengths={},this.originalTree.parents={}}},{key:"clearState",value:function(){this.root=!1,this.leaves=[],this.branches={},this.drawn=!1}},{key:"saveState",value:function(){return this.extractNestedBranches(),this.root.branchLength=0,this.maxBranchLength=0,this.root.setTotalLength(),0===this.maxBranchLength?void this.loadError(new Error("All branches in the tree are identical.")):void 0}},{key:"build",value:function(e,t,a){var n=this;this.originalTree={},this.clearState();var r=new l["default"];r.id="root",this.branches.root=r,this.setRoot(r),t.parse({formatString:e,root:r,options:a},function(t){return t?(a.callback&&a.callback(t),void n.loadError(t)):(n.stringRepresentation=e,n.saveState(),n.setInitialCollapsedBranches(),n.draw(),n.saveOriginalTree(),a.callback&&a.callback(),void(a.quiet||n.loadCompleted()))})}},{key:"pickup",value:function(e){return this.drawn?(this.origx=this.offsetx,this.origy=this.offsety,0===e.button&&(this.pickedup=!0),2===e.button&&this.rightClickZoom&&(this.zoomPickedUp=!0,this.origZoom=Math.log(this.zoom)/Math.log(10),this.oz=this.zoom),this.startx=e.clientX,void(this.starty=e.clientY)):!1}},{key:"redrawFromBranch",value:function(e){this.clearState(),this.resetTree(),this.originalTree.branchLengths[e.id]=e.branchLength,this.originalTree.parents[e.id]=e.parent,this.root=e,this.root.parent=!1,this.saveState(),this.draw(),this.subtreeDrawn(e.id)}},{key:"redrawOriginalTree",value:function(){this.load(this.stringRepresentation,{quiet:!0})}},{key:"storeNode",value:function(e){if(e.id&&""!==e.id||(e.id=e.tree.genId()),this.branches[e.id]&&e!==this.branches[e.id]){if(e.leaf)throw new Error("Two nodes on this tree share the id "+e.id);e.id=this.genId()}this.branches[e.id]=e,e.leaf&&this.leaves.push(e)}},{key:"scroll",value:function(e){var t=Math.log(this.zoom)/Math.log(10);this.setZoom(t+(e.detail<0||e.wheelDelta>0?.12:-.12)),e.preventDefault()}},{key:"selectNodes",value:function(e){var t,a,n,r=e;if(this.root){this.root.setSelected(!1,!0),"string"==typeof e&&(r=r.split(","));for(a in this.branches)if(this.branches.hasOwnProperty(a))for(t=this.branches[a],n=0;n<r.length;n++)r[n]===t.id&&t.setSelected(!0,!0);this.draw()}}},{key:"setFont",value:function(e){isNaN(e)&&(this.font=e,this.draw())}},{key:"setNodeDisplay",value:function(e,t,a){var n=this;if(e)if(this.drawn){var r=[];if(r="string"==typeof e?e.split(","):e,r.length){var i=!0,s=!1,o=void 0;try{for(var l,h=r[Symbol.iterator]();!(i=(l=h.next()).done);i=!0){var c=l.value;c in this.branches&&this.branches[c].setDisplay(t)}}catch(d){s=!0,o=d}finally{try{!i&&h["return"]&&h["return"]()}finally{if(s)throw o}}this.draw()}}else a||!function(){var a=n,r=setInterval(function(){this.drawn&&(a.setNodeColourAndShape(e,t,!0),clearInterval(r))})}()}},{key:"setNodeSize",value:function(e){this.baseNodeSize=Number(e),this.draw()}},{key:"setRoot",value:function(e){e.canvas=this.canvas,e.tree=this,this.root=e}},{key:"setTextSize",value:function(e){this.textSize=Number(e),this.draw()}},{key:"setFontSize",value:function(e){this.textSize=this.calculateFontSize?this.calculateFontSize(e):Math.min(e/2,15),this.canvas.font=this.textSize+"pt "+this.font}},{key:"setTreeType",value:function(e,t){if(!(e in g["default"]))return b.fireEvent(this.canvasEl,"error",{error:new Error('"'+e+'" is not a known tree-type.')});var a=this.treeType;this.treeType=e,this.branchRenderer=g["default"][e].branchRenderer,this.prerenderer=g["default"][e].prerenderer,this.labelAlign=g["default"][e].labelAlign,this.scaleCollapsedNode=g["default"][e].scaleCollapsedNode,this.calculateFontSize=g["default"][e].calculateFontSize,this.drawn&&(this.drawn=!1,this.draw()),t||this.treeTypeChanged(a,e)}},{key:"setSize",value:function(e,t){this.canvas.canvas.width=e,this.canvas.canvas.height=t,this.navigator&&this.navigator.resize(),this.adjustForPixelRatio()}},{key:"setZoom",value:function(e){if(e>-2&&2>e){var t=this.zoom;this.zoom=Math.pow(10,e),this.offsetx=this.offsetx/t*this.zoom,this.offsety=this.offsety/t*this.zoom,this.draw()}}},{key:"toggleLabels",value:function(){this.showLabels=!this.showLabels,this.draw()}},{key:"setMaxLabelLength",value:function(){var e;void 0===this.maxLabelLength[this.treeType]&&(this.maxLabelLength[this.treeType]=0);for(var t=0;t<this.leaves.length;t++)e=this.canvas.measureText(this.leaves[t].id),e.width>this.maxLabelLength[this.treeType]&&(this.maxLabelLength[this.treeType]=e.width)}},{key:"loadCompleted",value:function(){b.fireEvent(this.canvasEl,"loaded")}},{key:"loadStarted",value:function(){b.fireEvent(this.canvasEl,"loading")}},{key:"loadError",value:function(e){b.fireEvent(this.canvasEl,"error",{error:e})}},{key:"subtreeDrawn",value:function(e){b.fireEvent(this.canvasEl,"subtree",{node:e})}},{key:"nodesSelected",value:function(e){b.fireEvent(this.canvasEl,"selected",{nodeIds:e})}},{key:"addListener",value:function(e,t){b.addEvent(this.canvasEl,e,t)}},{key:"getBounds",value:function(){for(var e=this.root.startx,t=this.root.startx,a=this.root.starty,n=this.root.starty,r=this.leaves.length;r--;){var i=this.leaves[r],s=this.alignLabels?this.labelAlign.getX(i):i.centerx,o=this.alignLabels?this.labelAlign.getY(i):i.centery,l=i.angle,h=i.getTotalSize();s+=h*Math.cos(l),o+=h*Math.sin(l),e=Math.min(e,s),t=Math.max(t,s),a=Math.min(a,o),n=Math.max(n,o)}return[[e,a],[t,n]]}},{key:"fitInPanel",value:function(){var e=this.getBounds(),t=e[0][0],a=e[1][0],n=e[0][1],r=e[1][1],i=50,s=[this.canvas.canvas.width-i,this.canvas.canvas.height-i];this.zoom=Math.min(s[0]/(a-t),s[1]/(r-n)),this.offsety=(r+n)*this.zoom/-2,this.offsetx=(a+t)*this.zoom/-2}},{key:"adjustForPixelRatio",value:function(){var e=m.getPixelRatio(this.canvas);this.canvas.canvas.style.height=this.canvas.canvas.height+"px",this.canvas.canvas.style.width=this.canvas.canvas.width+"px",e>1&&(this.canvas.canvas.width*=e,this.canvas.canvas.height*=e)}},{key:"treeTypeChanged",value:function(e,t){b.fireEvent(this.canvasEl,"typechanged",{oldType:e,newType:t})}},{key:"resetTree",value:function(){if(this.originalTree.branches){this.branches=this.originalTree.branches;var e=!0,t=!1,a=void 0;try{for(var n,r=Object.keys(this.originalTree.branchLengths)[Symbol.iterator]();!(e=(n=r.next()).done);e=!0){var i=n.value;this.branches[i].branchLength=this.originalTree.branchLengths[i],this.branches[i].parent=this.originalTree.parents[i]}}catch(s){t=!0,a=s}finally{try{!e&&r["return"]&&r["return"]()}finally{if(t)throw a}}this.leaves=this.originalTree.leaves,this.root=this.originalTree.root}}},{key:"rotateBranch",value:function(e){this.branches[e.id].rotate()}},{key:"extractNestedBranches",value:function(){this.branches={},this.leaves=[],this.storeNode(this.root),this.root.extractChildren()}},{key:"exportNwk",value:function(){var e=this.root.getNwk();return e.substr(0,e.lastIndexOf(")")+1)+";"}},{key:"resizeToContainer",value:function(){this.setSize(this.canvasEl.offsetWidth,this.canvasEl.offsetHeight)}},{key:"downloadAllLeafIds",value:function(){this.root.downloadLeafIdsFromBranch()}},{key:"exportCurrentTreeView",value:function(){y.setupDownloadLink(this.getPngUrl(),"phylocanvas.png")}},{key:"alignLabels",get:function(){return this.labelAlign&&this.labelAlignEnabled},set:function(e){this.labelAlignEnabled=e}}]),e}();t["default"]=k,k.prototype.on=k.prototype.addListener,e.exports=t["default"]},function(e,t,a){function n(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),s=a(4),o=a(5),l=a(7),h=n(l),c=function(){function e(){r(this,e),this.angle=0,this.branchLength=!1,this.canvas=null,this.centerx=0,this.centery=0,this.children=[],this.collapsed=!1,this.colour="rgba(0,0,0,1)",this.data={},this.id="",this.interx=0,this.intery=0,this.label=null,this.leaf=!0,this.maxChildAngle=0,this.minChildAngle=s.Angles.FULL,this.nodeShape="circle",this.parent=null,this.radius=1,this.selected=!1,this.startx=0,this.starty=0,this.totalBranchLength=0,this.tree={}}return i(e,[{key:"clicked",value:function(e,t){var a,n;if(!this.dragging){if(e<this.maxx&&e>this.minx&&t<this.maxy&&t>this.miny)return this;for(a=this.children.length-1;a>=0;a--)if(n=this.children[a].clicked(e,t))return n}}},{key:"drawLabel",value:function(){var e,t,a,n=this.tree.textSize,r=this.getLabel();this.canvas.font=n+"pt "+this.tree.font,e=this.canvas.measureText(r),void 0===this.tree.maxLabelLength[this.tree.treeType]&&(this.tree.maxLabelLength[this.tree.treeType]=0),e.width>this.tree.maxLabelLength[this.tree.treeType]&&(this.tree.maxLabelLength[this.tree.treeType]=e.width),t=this.getLabelStartX(),a=n/2,this.tree.alignLabels&&(t+=Math.abs(this.tree.labelAlign.getLabelOffset(this))),this.angle>s.Angles.QUARTER&&this.angle<s.Angles.HALF+s.Angles.QUARTER&&(this.canvas.rotate(s.Angles.HALF),t=-t-1*e.width),this.canvas.beginPath(),this.canvas.fillStyle=this.getTextColour(),this.canvas.fillText(r,t,a),this.canvas.closePath(),this.angle>s.Angles.QUARTER&&this.angle<s.Angles.HALF+s.Angles.QUARTER&&this.canvas.rotate(s.Angles.HALF)}},{key:"setNodeDimensions",value:function(e,t,a){var n=a;(a*this.tree.zoom<5||!this.leaf)&&(n=5/this.tree.zoom),this.minx=e-n,this.maxx=e+n,this.miny=t-n,this.maxy=t+n}},{key:"drawCollapsed",value:function(e,t){var a=this.getChildIds(),n=a.length;this.tree.scaleCollapsedNode&&(n=this.tree.scaleCollapsedNode(n)),this.canvas.globalAlpha=.3,this.canvas.beginPath(),this.canvas.arc(e,t,n,0,2*Math.PI,!1),this.canvas.fillStyle=this.tree.defaultCollapsedOptions.color?this.tree.defaultCollapsedOptions.color:"purple",this.canvas.fill(),this.canvas.globalAlpha=1,this.canvas.closePath()}},{key:"drawLabelConnector",value:function(e,t){var a=this.canvas.lineWidth,n=this.tree.labelAlign;this.canvas.lineWidth=this.canvas.lineWidth/4,this.canvas.strokeStyle=this.highlighted?this.tree.highlightColour:this.getColour(),this.canvas.beginPath(),this.canvas.moveTo(e,t),this.canvas.lineTo(n.getX(this),n.getY(this)),this.canvas.stroke(),this.canvas.closePath(),this.canvas.strokeStyle=this.getColour(),this.canvas.lineWidth=a,this.canvas.moveTo(e,t)}},{key:"drawLeaf",value:function(){h["default"][this.nodeShape](this),(this.tree.showLabels||this.tree.hoverLabel&&this.highlighted)&&this.drawLabel()}},{key:"drawHighlight",value:function(e,t){this.canvas.beginPath();var a=this.canvas.lineWidth;this.canvas.strokeStyle=this.tree.highlightColour,this.canvas.lineWidth=this.tree.highlightWidth/this.tree.zoom,this.canvas.arc(e,t,(this.leaf?this.getNodeSize():0)+(5+this.tree.highlightWidth/2)/this.tree.zoom,0,s.Angles.FULL,!1),this.canvas.stroke(),this.canvas.lineWidth=a,this.canvas.strokeStyle=this.tree.branchColour,this.canvas.closePath()}},{key:"drawNode",value:function(){var e=this.getNodeSize(),t=e,a=this.leaf?t*Math.cos(this.angle)+this.centerx:this.centerx,n=this.leaf?t*Math.sin(this.angle)+this.centery:this.centery;this.canvas.fillStyle=this.selected?this.tree.selectedColour:this.colour,this.setNodeDimensions(a,n,e),this.collapsed?this.drawCollapsed(a,n):this.leaf&&(this.tree.alignLabels&&this.drawLabelConnector(a,n),this.canvas.save(),this.canvas.translate(this.centerx,this.centery),this.canvas.rotate(this.angle),this.drawLeaf(),this.canvas.restore()),this.highlighted&&this.drawHighlight(a,n)}},{key:"getChildIds",value:function(){var e,t=[];if(this.leaf)return[this.id];for(t=[],e=0;e<this.children.length;e++)t=t.concat(this.children[e].getChildIds());return t}},{key:"getChildCount",value:function(){var e,t=0;if(this.leaf)return 1;for(e=0;e<this.children.length;e++)t+=this.children[e].getChildCount();return t}},{key:"getChildYTotal",value:function(){var e,t=0;if(this.leaf)return this.centery;for(e=0;e<this.children.length;e++)t+=this.children[e].getChildYTotal();return t}},{key:"setSelected",value:function(e,t){var a=this.id,n=0;if(this.selected=e,t)for(n=0;n<this.children.length;n++)a=a+","+this.children[n].setSelected(e,t);return a}},{key:"setHighlighted",value:function(e){var t;if(this.highlighted=e,!e)for(t=0;t<this.children.length;t++)this.children[t].setHighlighted(e)}},{key:"reset",value:function(){var e,t;for(this.startx=0,this.starty=0,this.centerx=0,this.centery=0,this.angle=null,this.minChildAngle=s.Angles.FULL,this.maxChildAngle=0,t=0;t<this.children.length;t++)try{this.children[e].pcReset()}catch(a){return a}}},{key:"redrawTreeFromBranch",value:function(){this.tree.redrawFromBranch(this)}},{key:"extractChildren",value:function(){var e=!0,t=!1,a=void 0;try{for(var n,r=this.children[Symbol.iterator]();!(e=(n=r.next()).done);e=!0){var i=n.value;this.tree.storeNode(i),i.extractChildren()}}catch(s){t=!0,a=s}finally{try{!e&&r["return"]&&r["return"]()}finally{if(t)throw a}}}},{key:"hasCollapsedAncestor",value:function(){return this.parent?this.parent.collapsed||this.parent.hasCollapsedAncestor():!1}},{key:"collapse",value:function(){this.collapsed=this.leaf===!1}},{key:"expand",value:function(){this.collapsed=!1}},{key:"toggleCollapsed",value:function(){this.collapsed?this.expand():this.collapse()}},{key:"setTotalLength",value:function(){var e;for(this.parent?(this.totalBranchLength=this.parent.totalBranchLength+this.branchLength,this.totalBranchLength>this.tree.maxBranchLength&&(this.tree.maxBranchLength=this.totalBranchLength)):(this.totalBranchLength=this.branchLength,this.tree.maxBranchLength=this.totalBranchLength),e=0;e<this.children.length;e++)this.children[e].setTotalLength()}},{key:"addChild",value:function(e){e.parent=this,e.canvas=this.canvas,e.tree=this.tree,this.leaf=!1,this.children.push(e)}},{key:"getChildColours",value:function(){var e=[];return this.children.forEach(function(t){var a=0===t.children.length?t.colour:t.getColour();-1===e.indexOf(a)&&e.push(a)}),e}},{key:"getColour",value:function(){var e;return this.selected?this.tree.selectedColour:this.tree.backColour===!0?this.children.length?(e=this.getChildColours(),1===e.length?e[0]:this.tree.branchColour):this.colour:"function"==typeof this.tree.backColour?this.tree.backColour(this):this.tree.branchColour}},{key:"getNwk",value:function(){var e,t,a;if(this.leaf)return this.id+":"+this.branchLength;for(e=[],t=0;t<this.children.length;t++)e.push(this.children[t].getNwk());return a="("+e.join(",")+"):"+this.branchLength}},{key:"getTextColour",value:function(){var e,t;return this.selected?this.tree.selectedColour:(this.highlighted?e=this.tree.highlightColour:this.tree.backColour?this.children.length?(t=this.getChildColours(),e=1===t.length?t[0]:this.tree.branchColour):e=this.colour:e=this.tree.branchColour,e)}},{key:"getLabel",value:function(){return void 0!==this.label&&null!==this.label?this.label:""}},{key:"getLabelSize",value:function(){return this.tree.canvas.measureText(this.getLabel()).width}},{key:"getNodeSize",value:function(){return Math.max(0,this.tree.baseNodeSize*this.radius)}},{key:"getLabelStartX",value:function(){return this.getNodeSize()+this.tree.baseNodeSize+2*this.radius}},{key:"rotate",value:function(e){var t,a=[];for(t=this.children.length;t--;)a.push(this.children[t]);this.children=a,e.preventredraw||(this.tree.extractNestedBranches(),this.tree.draw(!0))}},{key:"getChildNo",value:function(){return this.parent.children.indexOf(this)}},{key:"downloadLeafIdsFromBranch",value:function(){var e=this.getChildIds().join("\n");o.setupDownloadLink(o.createBlobUrl(e),"pc_leaves.txt")}},{key:"setDisplay",value:function(e){var t=e.colour,a=e.shape,n=e.size;t&&(this.colour=t),a&&(this.nodeShape=s.Shapes[a]?s.Shapes[a]:a),n&&(this.radius=n)}},{key:"getTotalSize",value:function(){var e=this.getNodeSize();return this.tree.showLabels&&(e+=this.getLabelSize()+this.tree.maxLabelLength[this.tree.treeType]),e}}]),e}();t["default"]=c,e.exports=t["default"]},function(e,t,a){Object.defineProperty(t,"__esModule",{value:!0});var n={FORTYFIVE:Math.PI/4,QUARTER:Math.PI/2,HALF:Math.PI,FULL:2*Math.PI};t.Angles=n;var r={x:"star",s:"square",o:"circle",t:"triangle"};t.Shapes=r},function(e,t,a){function n(e){var t=new Blob([e],{type:"text/csv;charset=utf-8"});return d.createObjectURL(t)}function r(e,t){var a=document.createElement("a"),n="undefined"!=typeof a.download;a.href=e,a.target="_blank",n&&(a.download=t),c.fireEvent(a,"click"),n&&d.revokeObjectURL(a.href)}function i(e){for(var t=0;e;)t+=e.offsetLeft,e=e.offsetParent;return t}function s(e){for(var t=0;e;)t+=e.offsetTop,e=e.offsetParent;return t}function o(e,t){var a=e.className.split(" ");-1===a.indexOf(t)&&(a.push(t),e.className=a.join(" "))}function l(e,t){var a=e.className.split(" "),n=a.indexOf(t);-1!==n&&(a.splice(n,1),e.className=a.join(" "))}function h(e,t){var a=e.className.split(" "),n=a.indexOf(t);return-1!==n}Object.defineProperty(t,"__esModule",{value:!0}),t.createBlobUrl=n,t.setupDownloadLink=r,t.getX=i,t.getY=s,t.addClass=o,t.removeClass=l,t.hasClass=h;var c=a(6),d=window.URL||window.webkitURL},function(e,t,a){function n(e){return e.preventDefault(),!1}function r(e,t){var a,n,r=void 0===arguments[2]?{}:arguments[2];document.createEvent?(a=document.createEvent("HTMLEvents"),a.initEvent(t,!0,!0)):(a=document.createEventObject(),a.eventType=t),a.eventName=t;for(n in r)r.hasOwnProperty(n)&&(a[n]=r[n]);document.createEvent?e.dispatchEvent(a):e.fireEvent("on"+a.eventType,a)}function i(e,t,a){e.addEventListener?e.addEventListener(t,a,!1):e.attachEvent("on"+t,function(){return a.call(e,window.event)})}function s(e){e.stopPropagation(),e.preventDefault()}function o(e,t){var a;return a="string"==typeof t?function(a){return e[t]?e[t](a):void 0}:function(){return t(e)}}Object.defineProperty(t,"__esModule",{value:!0}),t.preventDefault=n,t.fireEvent=r,t.addEvent=i,t.killEvent=s,t.createHandler=o},function(e,t,a){Object.defineProperty(t,"__esModule",{value:!0});var n=a(4);t["default"]={circle:function(e){var t=e.getNodeSize();e.canvas.beginPath(),e.canvas.arc(t,0,t,0,n.Angles.FULL,!1),e.canvas.stroke(),e.canvas.fill(),e.canvas.closePath()},square:function(e){var t=e.getNodeSize(),a=0,n=2*t,r=-t,i=t;e.canvas.beginPath(),e.canvas.moveTo(a,r),e.canvas.lineTo(a,i),e.canvas.lineTo(n,i),e.canvas.lineTo(n,r),e.canvas.lineTo(a,r),e.canvas.stroke(),e.canvas.fill(),e.canvas.closePath()},star:function(e){var t=e.getNodeSize(),a=t,n=0,r=8,i=t,s=.5*t,o=Math.PI/2*3,l=a,h=n,c=Math.PI/r,d=0;for(e.canvas.beginPath(),e.canvas.moveTo(a,n-i),d=0;r>d;d++)l=a+Math.cos(o)*i,h=n+Math.sin(o)*i,e.canvas.lineTo(l,h),o+=c,l=a+Math.cos(o)*s,h=n+Math.sin(o)*s,e.canvas.lineTo(l,h),o+=c;e.canvas.lineTo(a,n-i),e.canvas.stroke(),e.canvas.fill(),e.canvas.closePath()},triangle:function(e){var t=e.getNodeSize(),a=2*t*Math.cos(30*Math.PI/180);e.canvas.beginPath(),e.canvas.moveTo(0,0),e.canvas.rotate(30*Math.PI/180),e.canvas.lineTo(a,0),e.canvas.rotate(-60*Math.PI/180),e.canvas.lineTo(a,0),e.canvas.rotate(30*Math.PI/180),e.canvas.lineTo(0,0),e.canvas.stroke(),e.canvas.fill(),e.canvas.closePath()}},e.exports=t["default"]},function(e,t,a){function n(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)}function s(e,t){return t?t.leaf&&"internal"!==e.nodeType?!0:t.leaf||"internal"!==e.nodeType?!1:!0:!e.nodeType}function o(e){e.style.backgroundColor="#E2E3DF"}function l(e){e.style.backgroundColor="transparent"}function h(e){var t=e.handler,a=e.text,n=void 0===a?"New menu Item":a,r=e.nodeType;return{handler:t,text:n,nodeType:r}}Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),d=function(e,t,a){for(var n=!0;n;){var r=e,i=t,s=a;o=h=l=void 0,n=!1,null===r&&(r=Function.prototype);var o=Object.getOwnPropertyDescriptor(r,i);if(void 0!==o){if("value"in o)return o.value;var l=o.get;return void 0===l?void 0:l.call(s)}var h=Object.getPrototypeOf(r);if(null===h)return void 0;e=h,t=i,a=s,n=!0}},u=a(9),f=n(u),v=a(6),p=[{text:"Collapse/Expand Branch",handler:function(e){e.toggleCollapsed(),e.tree.draw()},nodeType:"internal"},{text:"Rotate Branch",handler:"rotate",nodeType:"internal"},{text:"Redraw Subtree",handler:"redrawTreeFromBranch",nodeType:"internal"},{text:"Show/Hide Labels",handler:"toggleLabels"},{text:"Redraw Original Tree",handler:"redrawOriginalTree"},{text:"Export As Image",handler:"exportCurrentTreeView"},{text:"Export Leaf IDs",handler:"downloadAllLeafIds"},{text:"Export Leaf IDs on Branch",handler:"downloadLeafIdsFromBranch",nodeType:"internal"}],g=function(e){function t(e){var a=void 0===arguments[1]?p:arguments[1];r(this,t),d(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,"pc-context-menu"),this.menuItems=a.map(h),this.fontSize="8pt"}return i(t,e),c(t,[{key:"click",value:function(){v.createHandler(this,"close")}},{key:"createContent",value:function(e){var t=document.createElement("ul");t.style.margin="0",t.style.padding="0";var a=!0,n=!1,r=void 0;try{for(var i,h=this.menuItems[Symbol.iterator]();!(a=(i=h.next()).done);a=!0){var c=i.value;if(s(c,e)){var d=this.createElement("li",c.text);d.style.listStyle="none outside none",c.nodeType?d.addEventListener("click",v.createHandler(e,c.handler)):d.addEventListener("click",v.createHandler(this.tree,c.handler)),
d.addEventListener("click",this.click),d.addEventListener("contextmenu",v.preventDefault),d.addEventListener("mouseover",v.createHandler(d,o)),d.addEventListener("mouseout",v.createHandler(d,l)),t.appendChild(d)}}}catch(u){n=!0,r=u}finally{try{!a&&h["return"]&&h["return"]()}finally{if(n)throw r}}document.body.addEventListener("click",v.createHandler(this,"close")),this.element.appendChild(t)}}]),t}(f["default"]);t["default"]=g,e.exports=t["default"]},function(e,t,a){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),i=function(){function e(t){var a=void 0===arguments[1]?"pc-tooltip":arguments[1],r=void 0===arguments[2]?document.createElement("div"):arguments[2];n(this,e),this.tree=t,this.element=r,this.element.className=a,this.element.style.display="none",this.element.style.position="fixed",this.element.style.border="1px solid #CCCCCC",this.element.style.background="#FFFFFF",this.element.style.letterSpacing="0.5px",this.closed=!0,this.tree.canvasEl.appendChild(this.element)}return r(e,[{key:"close",value:function(){this.element.style.display="none",this.closed=!0}},{key:"createElement",value:function(e,t){var a=document.createElement(e);return a.style.cursor="pointer",a.style.padding="0.3em 0.5em 0.3em 0.5em",a.style.fontFamily=this.tree.font,a.style.fontSize=this.fontSize||"12pt",a.appendChild(document.createTextNode(t)),a}},{key:"createContent",value:function(e){this.element.appendChild(this.createElement("div",e.getChildIds().length))}},{key:"open",value:function(e,t,a){for(void 0===e&&(e=100),void 0===t&&(t=100);this.element.hasChildNodes();)this.element.removeChild(this.element.firstChild);this.createContent(a),this.element.style.top=t+"px",this.element.style.left=e+"px",this.element.style.zIndex=2e3,this.element.style.display="block",this.element.style.backgroundColor="#FFFFFF",this.closed=!1}}]),e}();t["default"]=i,e.exports=t["default"]},function(e,t,a){function n(e){this.tree=e,this.cel=document.createElement("canvas"),this.cel.id=this.tree.canvasEl.id+"Navi",this.cel.style.zIndex="100",this.cel.style.backgroundColor="#FFFFFF",this.cel.width=this.tree.canvas.canvas.width/3,this.cel.height=this.tree.canvas.canvas.height/3,this.cel.style.position="absolute",this.cel.style.bottom="0px",this.cel.style.right="0px",this.cel.style.border="1px solid #CCCCCC",this.tree.canvasEl.appendChild(this.cel),this.ctx=this.cel.getContext("2d"),this.ctx.translate(this.cel.width/2,this.cel.height/2),this.ctx.save()}n.prototype.drawFrame=function(){var e,t,a,n=this.cel.width,r=this.cel.height,i=n/2,s=r/2;this.ctx.restore(),this.ctx.save(),this.ctx.clearRect(-i,-s,n,r),this.ctx.strokeStyle="rgba(180,180,255,1)",this.tree.drawn?this.ctx.drawImage(this.img,-i,-s,this.cel.width,this.cel.height):(e=this.tree.canvas.canvas.toDataURL(),this.img=document.createElement("img"),this.img.src=e,t=this,this.img.onload=function(){t.ctx.drawImage(t.img,-i,-s,t.cel.width,t.cel.height)},this.baseOffsetx=this.tree.offsetx,this.baseOffsety=this.tree.offsety,this.baseZoom=this.tree.zoom),a=1/(this.tree.zoom/this.baseZoom),this.ctx.lineWidth=this.ctx.lineWidth/a,this.ctx.translate((this.baseOffsetx-this.tree.offsetx*a)*a,(this.baseOffsety-this.tree.offsety*a)*a),this.ctx.scale(a,a),this.ctx.strokeRect(-i,-s,n,r)},n.prototype.resize=function(){this.cel.width=this.tree.canvas.canvas.width/3,this.cel.height=this.tree.canvas.canvas.height/3,this.ctx.translate(this.cel.width/2,this.cel.height/2),this.drawFrame()},e.exports=n},function(e,t,a){function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(12),i=n(r),s=a(17),o=n(s),l=a(20),h=n(l),c=a(23),d=n(c),u=a(26),f=n(u);t["default"]={rectangular:i["default"],circular:o["default"],radial:h["default"],diagonal:d["default"],hierarchical:f["default"]},e.exports=t["default"]},function(e,t,a){function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(13),i=n(r),s=a(14),o=n(s),l=a(15),h=n(l),c=a(16),d=n(c),u={getX:function(e){return e.tree.farthestNodeFromRootX+e.getNodeSize()},getY:function(e){return e.centery},getLabelOffset:function(e){return e.tree.farthestNodeFromRootX-e.centerx}};t["default"]={branchRenderer:new i["default"](h["default"]),prerenderer:new o["default"](d["default"]),labelAlign:u},e.exports=t["default"]},function(e,t,a){function n(e){if(!e||!e.draw)throw new Error("`draw` function is required for branch renderers");this.draw=e.draw,this.prepareChild=e.prepareChild}n.prototype.render=function(e,t,a){var n;if(!a&&t)for(t.selected?t.canvas.fillStyle=e.selectedColour:t.canvas.fillStyle=t.colour,t.canvas.strokeStyle=t.getColour(),this.draw(e,t),t.drawNode(),n=0;n<t.children.length;n++)this.prepareChild&&this.prepareChild(t,t.children[n]),this.render(e,t.children[n],t.collapsed||a)},e.exports=n},function(e,t,a){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),i=function(){function e(t){n(this,e),this.getStep=t.getStep,this.calculate=t.calculate}return r(e,[{key:"run",value:function(e){var t=this.getStep(e);e.root.startx=0,e.root.starty=0,e.root.centerx=0,e.root.centery=0,e.farthestNodeFromRootX=0,e.farthestNodeFromRootY=0,this.calculate(e,t),e.root.startx=e.root.centerx,e.root.starty=e.root.centery,e.setFontSize(t),e.setMaxLabelLength()}}]),e}();t["default"]=i,e.exports=t["default"]},function(e,t,a){Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={draw:function(e,t){var a=t.branchLength*e.branchScalar;t.angle=0,t.parent&&(t.centerx=t.startx+a),t.canvas.beginPath(),t.canvas.moveTo(t.startx,t.starty),t.canvas.lineTo(t.startx,t.centery),t.canvas.lineTo(t.centerx,t.centery),t.canvas.stroke(),t.canvas.closePath()},prepareChild:function(e,t){t.startx=e.centerx,t.starty=e.centery}},e.exports=t["default"]},function(e,t,a){Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={getStep:function(e){return Math.max(e.canvas.canvas.height/(e.leaves.length+2),2*(e.leaves[0].getNodeSize()+2))},calculate:function(e,t){e.branchScalar=e.canvas.canvas.width/e.maxBranchLength;for(var a=0;a<e.leaves.length;a++){e.leaves[a].angle=0,e.leaves[a].centery=a>0?e.leaves[a-1].centery+t:0,e.leaves[a].centerx=e.leaves[a].totalBranchLength*e.branchScalar,e.leaves[a].centerx>e.farthestNodeFromRootX&&(e.farthestNodeFromRootX=e.leaves[a].centerx),e.leaves[a].centery>e.farthestNodeFromRootY&&(e.farthestNodeFromRootY=e.leaves[a].centery);for(var n=e.leaves[a];n.parent;n=n.parent){var r=n.parent.children;n.parent.centery=(r[0].centery+r[r.length-1].centery)/2}}}},e.exports=t["default"]},function(e,t,a){function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(13),i=n(r),s=a(14),o=n(s),l=a(18),h=n(l),c=a(19),d=n(c),u={getX:function(e){return e.centerx+e.labelOffsetX},getY:function(e){return e.centery+e.labelOffsetY},getLabelOffset:function(e){return e.labelOffsetX/Math.cos(e.angle)-e.getNodeSize()}};t["default"]={branchRenderer:new i["default"](h["default"]),prerenderer:new o["default"](d["default"]),labelAlign:u,scaleCollapsedNode:function(e){return e/3},calculateFontSize:function(e){return Math.min(10*e+4,40)}},e.exports=t["default"]},function(e,t,a){Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={draw:function(e,t){var a=t.totalBranchLength*e.branchScalar;t.canvas.beginPath(),t.canvas.moveTo(t.startx,t.starty),t.canvas.lineTo(t.centerx,t.centery),t.canvas.stroke(),t.canvas.closePath(),t.canvas.strokeStyle=t.getColour(),t.children.length>1&&!t.collapsed&&(t.canvas.beginPath(),t.canvas.arc(0,0,a,t.minChildAngle,t.maxChildAngle,t.maxChildAngle<t.minChildAngle),t.canvas.stroke(),t.canvas.closePath())}},e.exports=t["default"]},function(e,t,a){Object.defineProperty(t,"__esModule",{value:!0});var n=a(4);t["default"]={getStep:function(e){return n.Angles.FULL/e.leaves.length},calculate:function(e,t){e.branchScalar=Math.min(e.canvas.canvas.width,e.canvas.canvas.height)/e.maxBranchLength;var a=e.leaves.length*e.leaves[0].getNodeSize()*2/n.Angles.FULL;e.branchScalar*e.maxBranchLength>a?a=e.branchScalar*e.maxBranchLength:e.branchScalar=a/e.maxBranchLength;for(var r=0;r<e.leaves.length;r++){var i=e.leaves[r];for(i.angle=t*r,i.startx=i.parent.totalBranchLength*e.branchScalar*Math.cos(i.angle),i.starty=i.parent.totalBranchLength*e.branchScalar*Math.sin(i.angle),i.centerx=i.totalBranchLength*e.branchScalar*Math.cos(i.angle),i.centery=i.totalBranchLength*e.branchScalar*Math.sin(i.angle),i.labelOffsetX=(a+4*i.getNodeSize())*Math.cos(i.angle)-i.centerx,i.labelOffsetY=(a+4*i.getNodeSize())*Math.sin(i.angle)-i.centery;i.parent&&(0===i.getChildNo()&&(i.parent.angle=i.angle,i.parent.minChildAngle=i.angle),i.getChildNo()===i.parent.children.length-1);i=i.parent)i.parent.maxChildAngle=i.angle,i.parent.angle=(i.parent.minChildAngle+i.parent.maxChildAngle)/2,i.parent.startx=(i.parent.totalBranchLength-i.parent.branchLength)*e.branchScalar*Math.cos(i.parent.angle),i.parent.starty=(i.parent.totalBranchLength-i.parent.branchLength)*e.branchScalar*Math.sin(i.parent.angle),i.parent.centerx=i.parent.totalBranchLength*e.branchScalar*Math.cos(i.parent.angle),i.parent.centery=i.parent.totalBranchLength*e.branchScalar*Math.sin(i.parent.angle)}}},e.exports=t["default"]},function(e,t,a){function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(13),i=n(r),s=a(14),o=n(s),l=a(21),h=n(l),c=a(22),d=n(c);t["default"]={branchRenderer:new i["default"](h["default"]),prerenderer:new o["default"](d["default"]),scaleCollapsedNode:function(e){return e/7},calculateFontSize:function(e){return Math.min(50*e+5,15)}},e.exports=t["default"]},function(e,t,a){Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={draw:function(e,t){t.canvas.beginPath(),t.canvas.moveTo(t.startx,t.starty),t.canvas.lineTo(t.centerx,t.centery),t.canvas.stroke(),t.canvas.closePath()}},e.exports=t["default"]},function(e,t,a){function n(e,t){t.parent?(t.startx=t.parent.centerx,t.starty=t.parent.centery):(t.startx=0,t.starty=0),t.centerx=t.startx+t.branchLength*e.branchScalar*Math.cos(t.angle),t.centery=t.starty+t.branchLength*e.branchScalar*Math.sin(t.angle);for(var a=0;a<t.children.length;a++)n(e,t.children[a])}Object.defineProperty(t,"__esModule",{value:!0});var r=a(4);t["default"]={getStep:function(e){return r.Angles.FULL/e.leaves.length},calculate:function(e,t){e.branchScalar=Math.min(e.canvas.canvas.width,e.canvas.canvas.height)/e.maxBranchLength;for(var a=0;a<e.leaves.length;a+=1){e.leaves[a].angle=t*a,e.leaves[a].centerx=e.leaves[a].totalBranchLength*e.branchScalar*Math.cos(e.leaves[a].angle),e.leaves[a].centery=e.leaves[a].totalBranchLength*e.branchScalar*Math.sin(e.leaves[a].angle);for(var r=e.leaves[a];r.parent&&(0===r.getChildNo()&&(r.parent.angle=0),r.parent.angle+=r.angle*r.getChildCount(),r.getChildNo()===r.parent.children.length-1);r=r.parent)r.parent.angle=r.parent.angle/r.parent.getChildCount()}n(e,e.root)}},e.exports=t["default"]},function(e,t,a){function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(13),i=n(r),s=a(14),o=n(s),l=a(24),h=n(l),c=a(25),d=n(c);t["default"]={branchRenderer:new i["default"](h["default"]),prerenderer:new o["default"](d["default"]),calculateFontSize:function(e){return Math.min(e/2,7.5)}},e.exports=t["default"]},function(e,t,a){Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={draw:function(e,t){t.angle=0,t.canvas.beginPath(),t.canvas.moveTo(t.startx,t.starty),t.canvas.lineTo(t.centerx,t.centery),t.canvas.stroke(),t.canvas.closePath()},prepareChild:function(e,t){t.startx=e.centerx,t.starty=e.centery}},e.exports=t["default"]},function(e,t,a){Object.defineProperty(t,"__esModule",{value:!0});var n=a(4);t["default"]={getStep:function(e){return Math.max(e.canvas.canvas.height/(e.leaves.length+2),2*(e.leaves[0].getNodeSize()+2))},calculate:function(e,t){for(var a=0;a<e.leaves.length;a++){e.leaves[a].centerx=0,e.leaves[a].centery=a>0?e.leaves[a-1].centery+t:0,e.leaves[a].angle=0;for(var r=e.leaves[a];r.parent&&r.getChildNo()===r.parent.children.length-1;r=r.parent){r.parent.centery=r.parent.getChildYTotal()/r.parent.getChildCount(),r.parent.centerx=r.parent.children[0].centerx+(r.parent.children[0].centery-r.parent.centery)*Math.tan(n.Angles.FORTYFIVE);for(var i=0;i<r.parent.children.length;i++)r.parent.children[i].startx=r.parent.centerx,r.parent.children[i].starty=r.parent.centery}}}},e.exports=t["default"]},function(e,t,a){function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(13),i=n(r),s=a(14),o=n(s),l=a(27),h=n(l),c=a(28),d=n(c),u={getX:function(e){return e.centerx},getY:function(e){return e.tree.farthestNodeFromRootY+e.getNodeSize()},getLabelOffset:function(e){return e.tree.farthestNodeFromRootY-e.centery}};t["default"]={branchRenderer:new i["default"](h["default"]),prerenderer:new o["default"](d["default"]),labelAlign:u},e.exports=t["default"]},function(e,t,a){Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={draw:function(e,t){t.canvas.beginPath(),t!==t.tree.root&&(t.canvas.moveTo(t.startx,t.starty),t.canvas.lineTo(t.centerx,t.starty)),t.canvas.lineTo(t.centerx,t.centery),t.canvas.stroke(),t.canvas.closePath()}},e.exports=t["default"]},function(e,t,a){Object.defineProperty(t,"__esModule",{value:!0});var n=a(4);t["default"]={getStep:function(e){return Math.max(e.canvas.canvas.width/(e.leaves.length+2),2*(e.leaves[0].getNodeSize()+2))},calculate:function(e,t){e.branchScalar=e.canvas.canvas.height/e.maxBranchLength;for(var a=0;a<e.leaves.length;a++){e.leaves[a].angle=n.Angles.QUARTER,e.leaves[a].centerx=a>0?e.leaves[a-1].centerx+t:0,e.leaves[a].centery=e.leaves[a].totalBranchLength*e.branchScalar;for(var r=e.leaves[a];r.parent&&(0===r.getChildNo()&&(r.parent.centerx=r.centerx),r.getChildNo()===r.parent.children.length-1);r=r.parent){r.parent.angle=n.Angles.QUARTER,r.parent.centerx=(r.parent.centerx+r.centerx)/2,r.parent.centery=r.parent.totalBranchLength*e.branchScalar;for(var i=0;i<r.parent.children.length;i++)r.parent.children[i].startx=r.parent.centerx,r.parent.children[i].starty=r.parent.centery}e.leaves[a].centerx>e.farthestNodeFromRootX&&(e.farthestNodeFromRootX=e.leaves[a].centerx),e.leaves[a].centery>e.farthestNodeFromRootY&&(e.farthestNodeFromRootY=e.leaves[a].centery)}}},e.exports=t["default"]},function(e,t,a){function n(e){return e.backingStorePixelRatio||e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||1}function r(e){return(window.devicePixelRatio||1)/n(e)}function i(e){return e=e-l.getX(this.canvas.canvas)+window.pageXOffset,e*=r(this.canvas),e-=this.canvas.canvas.width/2,e-=this.offsetx,e/=this.zoom}function s(e){return e=e-l.getY(this.canvas.canvas)+window.pageYOffset,e*=r(this.canvas),e-=this.canvas.canvas.height/2,e-=this.offsety,e/=this.zoom}function o(e,t,a){return[i.call(a,e),s.call(a,t)]}Object.defineProperty(t,"__esModule",{value:!0}),t.getBackingStorePixelRatio=n,t.getPixelRatio=r,t.translateClick=o;var l=a(5)},function(e,t,a){function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(1),i=n(r),s=a(31),o=n(s),l=a(32),h=n(l);t["default"]={nexus:new i["default"](h["default"]),newick:new i["default"](o["default"])},e.exports=t["default"]},function(e,t,a){function n(e){return e&&e.__esModule?e:{"default":e}}function r(e){return this===e}function i(e){var t="",a=!0,n=!1,i=void 0;try{for(var s,o=e[Symbol.iterator]();!(a=(s=o.next()).done);a=!0){var l=s.value;if(p.some(r.bind(l)))break;t+=l}}catch(h){n=!0,i=h}finally{try{!a&&o["return"]&&o["return"]()}finally{if(n)throw i}}return t}function s(e,t){var a=e.split("**"),n={};if(t.id=a[0],1!==a.length){a=a[1].split("*");for(var r=0;r<a.length;r+=2){var i=a[r+1];switch(a[r]){case"nsz":n.size=window.parseInt(i);break;case"nsh":n.shape=i;break;case"ncol":n.colour=i}}t.setDisplay(n)}}function o(e){var t="",a=!0,n=!1,i=void 0;try{for(var s,o=e[Symbol.iterator]();!(a=(s=o.next()).done);a=!0){var l=s.value;if(g.some(r.bind(l)))break;t+=l}}catch(h){n=!0,i=h}finally{try{!a&&o["return"]&&o["return"]()}finally{if(n)throw i}}return t}function l(e,t,a){var n=i(t.slice(a)),r=a+n.length,l="";return n.match(/\*/)&&s(n,e),":"===t[r]?(l=o(t.slice(r+1)),e.branchLength=Math.max(parseFloat(l),0)):e.branchLength=0,n&&(e.label=n),e.id=n||e.tree.generateBranchId(),r+l.length}function h(e,t){for(var a=e.string,n=e.root,r=a.replace(/(\r|\n)/g,""),i=n,s=0;s<r.length;s++){var o=void 0;switch(r[s]){case"(":o=new d["default"],i.addChild(o),i=o;break;case")":i=i.parent;break;case",":o=new d["default"],i.parent.addChild(o),i=o;break;case";":break;default:try{s=l(i,r,s)}catch(h){return t(h)}}}return t()}Object.defineProperty(t,"__esModule",{value:!0});var c=a(3),d=n(c),u="newick",f=/\.nwk$/,v=/^[\w\W\.\*\:(\),-\/]+;\s?$/gi,p=[":",",",")",";"],g=[")",",",";"];t["default"]={format:u,fileExtension:f,validator:v,parseFn:h},e.exports=t["default"]},function(e,t,a){function n(e,t){var a=e.string,n=e.root,i=e.options;if(!a.match(/BEGIN TREES/gi))return t(new Error("The nexus file does not contain a tree block"));var s=i.name,o=a.match(/BEGIN TREES;[\S\s]+END;/i)[0].replace(/BEGIN TREES;\n/i,"").replace(/END;/i,""),l={},h=o.match(/TRANSLATE[^;]+;/i);if(h&&h.length){h=h[0],o=o.replace(h,""),h=h.replace(/translate|;/gi,"");for(var c=h.split(","),d=0;d<c.length;d++){var u=c[d].trim().replace("\n","").split(" ");u[0]&&u[1]&&(l[u[0].trim()]=u[1].trim())}}for(var f=o.split("\n"),v={},d=0;d<f.length;d++)if(""!==f[d].trim()){var p=f[d].replace(/tree\s/i,"");s||(s=p.trim().match(/^\w+/)[0]),v[s]=p.trim().match(/[\S]*$/)[0]}return v[s]?void r.parseFn({string:v[s].trim(),root:n},function(e){if(e)return t(e);if(t(),l){var a=!0,r=!1,i=void 0;try{for(var s,o=Object.keys(l)[Symbol.iterator]();!(a=(s=o.next()).done);a=!0){var h=s.value,c=n.tree.branches,d=c[h];delete c[h],d.id=l[h],c[d.id]=d}}catch(u){r=!0,i=u}finally{try{!a&&o["return"]&&o["return"]()}finally{if(r)throw i}}n.tree.draw()}}):new Error("tree "+s+" does not exist in this NEXUS file")}Object.defineProperty(t,"__esModule",{value:!0});var r=a(31),i="nexus",s=/\.n(ex|xs)$/,o=/^#NEXUS[\s\n;\w\W\.\*\:(\),-=\[\]\/&]+$/i;t["default"]={parseFn:n,format:i,fileExtension:s,validator:o},e.exports=t["default"]}])})},function(e,t,a){"use strict";!function(t,n){e.exports=n(a(1))}(void 0,function(e){return function(e){function t(n){if(a[n])return a[n].exports;var r=a[n]={exports:{},id:n,loaded:!1};return e[n].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var a={};return t.m=e,t.c=a,t.p="",t(0)}([function(e,t,a){function n(e){if(Array.isArray(e)){for(var t=0,a=Array(e.length);t<e.length;t++)a[t]=e[t];return a}return Array.from(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e){e(this,"createTree",function(e,t){var a=e.apply(void 0,n(t)),r=s(t,2),i=r[1],o=void 0===i?{}:i;if(o.history||"undefined"==typeof o.history){var l=o.history&&"undefined"!=typeof o.history.collapsed;a.historySnapshots=[],a.history=new d(a,l?o.history.collapsed:!0)}return a}),e(c.Tree,"resizeToContainer",function(e){return this.history?void this.history.resizeTree():e.apply(this)}),this.History=d}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){var a=[],n=!0,r=!1,i=void 0;try{for(var s,o=e[Symbol.iterator]();!(n=(s=o.next()).done)&&(a.push(s.value),!t||a.length!==t);n=!0);}catch(l){r=!0,i=l}finally{try{!n&&o["return"]&&o["return"]()}finally{if(r)throw i}}return a}return function(t,a){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,a);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();t["default"]=i;var l=a(1),h=a(2),c=a(3),d=function(){function e(t,a){r(this,e),this.tree=t,this.injectCss(),this.div=this.createDiv(t.canvasEl),this.tree.addListener("subtree",function(e){this.addSnapshot(e.node)}.bind(this)),this.tree.addListener("loaded",this.reset.bind(this)),this.tree.addListener("typechanged",function(){this.addSnapshot(this.tree.root.id)}.bind(this)),a?this.collapse():this.expand()}return o(e,[{key:"reset",value:function(){this.clear(),this.tree.drawn&&this.addSnapshot(this.tree.root.id)}},{key:"collapse",value:function(){l.addClass(this.div,"collapsed"),this.toggleDiv.firstChild.data=">",this.resizeTree(),this.tree.draw()}},{key:"expand",value:function(){l.removeClass(this.div,"collapsed"),this.toggleDiv.firstChild.data="<",this.resizeTree(),this.tree.draw()}},{key:"isCollapsed",value:function(){return l.hasClass(this.div,"collapsed")}},{key:"toggle",value:function(){this.isCollapsed()?this.expand():this.collapse(),h.fireEvent(this.tree.canvasEl,"historytoggle",{isOpen:!this.isCollapsed()})}},{key:"createDiv",value:function(e){var t=document.createElement("div");t.className="pc-history",h.addEvent(t,"click",h.killEvent),h.addEvent(t,"contextmenu",h.killEvent);var a=document.createElement("div");a.innerHTML="History",a.className="pc-history-title",t.appendChild(a);var n=document.createElement("div");n.appendChild(document.createTextNode("<")),n.className="toggle",h.addEvent(n,"click",this.toggle.bind(this)),t.appendChild(n),this.toggleDiv=n;var r=document.createElement("ul");return r.className="pc-history-snapshots",t.appendChild(r),this.snapshotList=r,e.appendChild(t),t}},{key:"resizeTree",value:function(){var e=this.tree;this.width=this.div.offsetWidth,e.setSize(e.canvasEl.offsetWidth-this.width,e.canvasEl.offsetHeight),this.isCollapsed()?e.canvasEl.getElementsByTagName("canvas")[0].style.marginLeft=this.width+"px":e.canvasEl.getElementsByTagName("canvas")[0].style.marginLeft="20%"}},{key:"addSnapshot",value:function(e){var t="phylocanvas-history-",a=this.tree.treeType,n=!1;if(this.tree.historySnapshots.forEach(function(r){r.style.background="transparent",r.id===t+e&&r.getAttribute("data-tree-type")===a&&(n=!0,r.style.background="lightblue")}),!n){var r=this.tree.getPngUrl(),i=document.createElement("li"),s=document.createElement("img");s.width=this.width,s.src=r,s.id=t+e,s.setAttribute("data-tree-type",this.tree.treeType),s.style.background="lightblue",this.tree.historySnapshots.push(s),i.appendChild(s),this.snapshotList.appendChild(i),h.addEvent(s,"click",this.goBackTo.bind(this))}}},{key:"clear",value:function(){for(var e=this.snapshotList.getElementsByTagName("li"),t=e.length;t--;)this.snapshotList.removeChild(e[0])}},{key:"goBackTo",value:function(e){var t=e.target;this.tree.setTreeType(t.getAttribute("data-tree-type"),!0),this.tree.redrawFromBranch(this.tree.originalTree.branches[t.id.replace("phylocanvas-history-","")])}},{key:"injectCss",value:function(){var e=".pc-history { position: absolute; top: 0; bottom: 0; left: 0; box-sizing: border-box; width: 20%; overflow: hidden; background: #EEE }.pc-history .pc-history-title { box-sizing: border-box; height: 20px; text-align: center; font-size: 13px; color: #666; padding: 2px; border-bottom: 1px solid #bbb }.pc-history .toggle { position: absolute; top: 0; right: 0; padding: 2px 8px; cursor: pointer; border-top-left-radius: 50%; border-bottom-left-radius: 50%; background-color: #666; color: #FFF; box-sizing: border-box; height: 20px; }.pc-history.collapsed .toggle { border-radius: 0 50% 50% 0 }.pc-history .toggle:hover { background-color: #FFF; color: #CCC }.pc-history.collapsed { width: 25px }.pc-history.collapsed .pc-history-snapshots { display: none }.pc-history.collapsed .pc-history-title { writing-mode: tb-rl; -webkit-transform: rotate(270deg); -moz-transform: rotate(270deg); -o-transform: rotate(270deg); -ms-transform: rotate(270deg); transform: rotate(270deg); margin-top: 70px; background: 0 0; color: #666; letter-spacing: 1.2px; border-bottom: none }.pc-history-snapshots { position: absolute; top: 20px; bottom: 0; margin: 0; padding: 0; overflow-x: hidden; overflow-y: scroll; }.pc-history-snapshots li { list-style: outside none none }.pc-history img { border: 0px solid #CCC; border-top-width: 1px; cursor: pointer; width: 100%; box-sizing: border-box; transition: background-color .25s ease; display: block }.pc-history img:hover { background-color: #fff }",t=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css",a.styleSheet?a.styleSheet.cssText=e:a.appendChild(document.createTextNode(e)),t.appendChild(a)}}]),e}();e.exports=t["default"]},function(e,t,a){function n(e){var t=new Blob([e],{type:"text/csv;charset=utf-8"});return d.createObjectURL(t)}function r(e,t){var a=document.createElement("a"),n="undefined"!=typeof a.download;a.href=e,a.target="_blank",n&&(a.download=t),c.fireEvent(a,"click"),n&&d.revokeObjectURL(a.href)}function i(e){for(var t=0;e;)t+=e.offsetLeft,e=e.offsetParent;return t}function s(e){for(var t=0;e;)t+=e.offsetTop,e=e.offsetParent;return t}function o(e,t){var a=e.className.split(" ");-1===a.indexOf(t)&&(a.push(t),e.className=a.join(" "))}function l(e,t){var a=e.className.split(" "),n=a.indexOf(t);-1!==n&&(a.splice(n,1),e.className=a.join(" "))}function h(e,t){var a=e.className.split(" "),n=a.indexOf(t);return-1!==n}Object.defineProperty(t,"__esModule",{value:!0}),t.createBlobUrl=n,t.setupDownloadLink=r,t.getX=i,t.getY=s,t.addClass=o,t.removeClass=l,t.hasClass=h;var c=a(2),d=window.URL||window.webkitURL},function(e,t){function a(e){return e.preventDefault(),!1}function n(e,t){var a,n,r=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];document.createEvent?(a=document.createEvent("HTMLEvents"),a.initEvent(t,!0,!0)):(a=document.createEventObject(),a.eventType=t),a.eventName=t;for(n in r)r.hasOwnProperty(n)&&(a[n]=r[n]);document.createEvent?e.dispatchEvent(a):e.fireEvent("on"+a.eventType,a)}function r(e,t,a){e.addEventListener?e.addEventListener(t,a,!1):e.attachEvent("on"+t,function(){return a.call(e,window.event)})}function i(e){e.stopPropagation(),e.preventDefault()}function s(e,t){var a;return a="string"==typeof t?function(a){return e[t]?e[t](a):void 0}:function(){return t(e)}}Object.defineProperty(t,"__esModule",{value:!0}),t.preventDefault=a,t.fireEvent=n,t.addEvent=r,t.killEvent=i,t.createHandler=s},function(t,a){t.exports=e}])})},function(e,t,a){"use strict";!function(t,n){e.exports=n(a(1))}(void 0,function(e){return function(e){function t(n){if(a[n])return a[n].exports;var r=a[n]={exports:{},id:n,loaded:!1};return e[n].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var a={};return t.m=e,t.c=a,t.p="",t(0)}([function(e,t,a){function n(e,t){var a=e.url,n=e.method,r=e.data,i=new XMLHttpRequest;i.onreadystatechange=function(){4===i.readyState&&t(i)},i.open(n,a,!0),"GET"===n?i.send():i.send(r)}function r(e){e(s.Tree,"build",function(e,t){var a=this,r=i(t,3),s=r[0],o=r[1],l=r[2];l.ajax||s.match(o.fileExtension)?n({url:s,method:"GET"},function(t){if(t.status>=400){var n=new Error(t.responseText);return l.callback&&l.callback(n),a.loadError(n)}e.call(a,t.responseText,o,l)}):e.apply(this,t)})}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){var a=[],n=!0,r=!1,i=void 0;try{for(var s,o=e[Symbol.iterator]();!(n=(s=o.next()).done)&&(a.push(s.value),!t||a.length!==t);n=!0);}catch(l){r=!0,i=l}finally{try{!n&&o["return"]&&o["return"]()}finally{if(r)throw i}}return a}return function(t,a){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,a);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t["default"]=r;var s=a(1);e.exports=t["default"]},function(t,a){t.exports=e}])})},function(e,t,a){"use strict";!function(t,n){e.exports=n(a(1))}(void 0,function(e){return function(e){function t(n){if(a[n])return a[n].exports;var r=a[n]={exports:{},id:n,loaded:!1};return e[n].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var a={};return t.m=e,t.c=a,t.p="",t(0)}([function(e,t,a){function n(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(Array.isArray(e)){for(var t=0,a=Array(e.length);t<e.length;t++)a[t]=e[t];return a}return Array.from(e)}function i(e){e(o["default"],"createTree",function(e,t){var a=e.apply(void 0,r(t));return a.showMetadata=!1,a.selectedMetadataColumns=[],a.metadataXStep=15,a.metadataHeadingDrawn=!1,a}),e(s.Tree,"draw",function(e,t){e.apply(this,t),this.metadataHeadingDrawn=!1}),e(s.Branch,"drawLeaf",function(e){e.call(this),this.tree.showMetadata&&this.drawMetadata()}),e(s.Branch,"getTotalSize",function(e){var t=e.call(this);return this.tree.showMetadata&&(t+=this.tree.getMetadataColumnHeadings().length*this.tree.metadataXStep),t})}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=i;var s=a(1),o=n(s);s.Tree.prototype.viewMetadataColumns=function(){var e=arguments.length<=0||void 0===arguments[0]?this.getMetadataColumnHeadings():arguments[0];this.showMetadata=!0,this.selectedMetadataColumns=e,this.fitInPanel(),this.draw()},s.Tree.prototype.getMetadataColumnHeadings=function(){for(var e=[],t=0;t<this.leaves.length;t++)if(Object.keys(this.leaves[t].data).length>0){e=Object.keys(this.leaves[t].data);break}return e},s.Tree.prototype.clearMetadata=function(){for(var e=0;e<this.leaves.length;e++)Object.keys(this.leaves[e].data).length>0&&(this.leaves[e].data={})},s.Branch.prototype.drawMetadata=function(){var e=0;(this.tree.showLabels||this.tree.hoverLabel&&this.highlighted)&&(e=this.tree.maxLabelLength[this.tree.treeType]);var t,a,n=this.getLabelStartX()+e,r=0,i=[],s=this.tree.textSize,o=this.tree.metadataXStep/2;this.tree.alignLabels&&("rectangular"===this.tree.treeType?n+=this.tree.farthestNodeFromRootX-this.centerx:"hierarchical"===this.tree.treeType&&(n+=this.tree.farthestNodeFromRootY-this.centery)),!this.tree.metadataHeadingDrawn&&this.tree.alignLabels&&"circular"!==this.tree.treeType&&"radial"!==this.tree.treeType&&(this.drawMetadataHeading(n,r),this.tree.metadataHeadingDrawn=!0);var l=this.tree.metadataXStep;if(Object.keys(this.data).length>0){for(this.canvas.beginPath(),i=this.tree.selectedMetadataColumns.length>0?this.tree.selectedMetadataColumns:Object.keys(this.data),r-=s/2,t=0;t<i.length;t++)a=i[t],n+=l,window.parseInt(this.data[a])?(this.canvas.fillStyle=this.tree.colour1,this.canvas.fillRect(n,r,o,s)):0===window.parseInt(this.data[a])&&(this.canvas.fillStyle=this.tree.colour0,this.canvas.fillRect(n,r,o,s));this.canvas.stroke(),this.canvas.closePath()}},s.Branch.prototype.drawMetadataHeading=function(e,t){var a,n,r;for(a=this.tree.selectedMetadataColumns.length>0?this.tree.selectedMetadataColumns:Object.keys(this.data),this.canvas.font="12px Sans-serif",this.canvas.fillStyle="black",r=0;r<a.length;r++)n=a[r],e+=this.tree.metadataXStep,this.canvas.rotate(-Math.PI/2),"rectangular"===this.tree.treeType?(this.canvas.textAlign="left",this.canvas.fillText(n,20,e+6)):"hierarchical"===this.tree.treeType?(this.canvas.textAlign="right",this.canvas.fillText(n,-20,e+8)):"diagonal"===this.tree.treeType&&(this.canvas.textAlign="left",this.canvas.fillText(n,20,e+6)),this.canvas.rotate(Math.PI/2)},e.exports=t["default"]},function(t,a){t.exports=e}])})}])});