!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):"object"==typeof exports?exports.PhyloCanvas=t():e.PhyloCanvas=t()}(this,function(){return function(e){function t(a){if(n[a])return n[a].exports;var r=n[a]={exports:{},id:a,loaded:!1};return e[a].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),n(3);var r=n(2),i=a(r),s=n(4),o=a(s),l=n(1),c=a(l),h=n(5),u=a(h),d=n(6),f=a(d);i["default"].plugin(o["default"]),i["default"].plugin(c["default"]),i["default"].plugin(u["default"]),i["default"].plugin(f["default"]),t["default"]=i["default"],e.exports=t["default"]},function(e,t,n){"use strict";!function(t,a){e.exports=a(n(2))}(void 0,function(e){return function(e){function t(a){if(n[a])return n[a].exports;var r=n[a]={exports:{},id:a,loaded:!1};return e[a].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){function a(e,t){var n=e.url,a=e.method,r=e.data,i=new XMLHttpRequest;i.onreadystatechange=function(){4===i.readyState&&t(i)},i.open(a,n,!0),"GET"===a?i.send():i.send(r)}function r(e){e(s.Tree,"build",function(e,t){var n=this,r=i(t,3),s=r[0],o=r[1],l=r[2];l.ajax||s.match(o.fileExtension)?a({url:s,method:"GET"},function(t){if(t.status>=400){var a=new Error(t.responseText);return l.callback&&l.callback(a),n.loadError(a)}e.call(n,t.responseText,o,l)}):e.apply(this,t)})}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){var n=[],a=!0,r=!1,i=void 0;try{for(var s,o=e[Symbol.iterator]();!(a=(s=o.next()).done)&&(n.push(s.value),!t||n.length!==t);a=!0);}catch(l){r=!0,i=l}finally{try{!a&&o["return"]&&o["return"]()}finally{if(r)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t["default"]=r;var s=n(1);e.exports=t["default"]},function(t,n){t.exports=e}])})},function(e,t,n){"use strict";!function(t,n){e.exports=n()}(void 0,function(){return function(e){function t(a){if(n[a])return n[a].exports;var r=n[a]={exports:{},id:a,loaded:!1};return e[a].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="/dist/",t(0)}([function(e,t,n){function a(e){return e&&e.__esModule?e:{"default":e}}function r(e,t,n){var a=e[t]?e:e.prototype,r=a[t];a[t]=function(){for(var e=arguments.length,t=Array(e),a=0;e>a;a++)t[a]=arguments[a];return n.call(this,r,t)}}function i(e){e.call(this,r)}function s(e){var t=void 0===arguments[1]?{}:arguments[1];return new l["default"](e,t)}Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),l=a(o),c=n(5),h=a(c),u=n(7),d=a(u),f=n(1),v=a(f),p=n(8),g=a(p),y=n(6),m=a(y);t.Tree=l["default"],t.Branch=h["default"],t.Tooltip=d["default"],t.Parser=v["default"],t.treeTypes=g["default"],t.nodeRenderers=m["default"],t["default"]={plugin:i,createTree:s}},function(e,t,n){function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=function(){function e(t){var n=t.format,r=t.parseFn,i=t.fileExtension,s=t.validator;a(this,e),this.format=n,this.parseFn=r,this.fileExtension=i,this.validator=s}return r(e,[{key:"parse",value:function(e,t){var n=e.formatString,a=e.root,r=e.options,i=void 0===r?{validate:!0}:r;return n.match(this.validator)||i.validate===!1?this.parseFn({string:n,root:a,options:i},t):t(new Error('Format string does not validate as "'+this.format+'"'))}}]),e}();t["default"]=i,e.exports=t["default"]},function(e,t,n){function a(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=n(4),l=n(5),c=a(l),h=n(7),u=n(3),d=a(u),f=n(8),v=a(f),p=n(26),g=a(p),y=o.dom.addClass,m=o.events.fireEvent,b=o.events.addEvent,x=o.canvas.getBackingStorePixelRatio,w=o.canvas.getPixelRatio,k=o.canvas.translateClick,S=function(){function e(t){var n=void 0===arguments[1]?{}:arguments[1];i(this,e),this.canvasEl="string"==typeof t?document.getElementById(t):t,y(this.canvasEl,"pc-container"),this.branches={},this.leaves=[],this.root=!1,this.stringRepresentation="",this.lastId=0,this.backColour=!1,this.originalTree={},"static"===window.getComputedStyle(this.canvasEl).position&&(this.canvasEl.style.position="relative"),this.canvasEl.style.boxSizing="border-box";var a=document.createElement("canvas");a.id=(t.id||"")+"__canvas",a.className="phylocanvas",a.style.position="relative",a.style.backgroundColor="#FFFFFF",a.height=t.offsetHeight||400,a.width=t.offsetWidth||400,a.style.zIndex="1",this.canvasEl.appendChild(a),this.defaultCollapsedOptions={},this.defaultCollapsed=!1,void 0!==n.defaultCollapsed&&n.defaultCollapsed.min&&n.defaultCollapsed.max&&(this.defaultCollapsedOptions=n.defaultCollapsed,this.defaultCollapsed=!0),this.tooltip=new h.ChildNodesTooltip(this),this.drawn=!1,this.highlighters=[],this.zoom=1,this.pickedup=!1,this.dragging=!1,this.startx=null,this.starty=null,this.pickedup=!1,this.baseNodeSize=1,this.curx=null,this.cury=null,this.origx=null,this.origy=null,this.canvas=a.getContext("2d"),this.canvas.canvas.onselectstart=function(){return!1},this.canvas.fillStyle="#000000",this.canvas.strokeStyle="#000000",this.canvas.save(),this.offsetx=this.canvas.canvas.width/2,this.offsety=this.canvas.canvas.height/2,this.selectedColour="rgba(49,151,245,1)",this.highlightColour="rgba(49,151,245,1)",this.highlightWidth=4,this.highlightSize=2,this.selectedNodeSizeIncrease=0,this.branchColour="rgba(0,0,0,1)",this.branchScalar=1,this.padding=n.padding||50,this.labelPadding=5,this.hoverLabel=!1,this.internalNodesSelectable=!0,this.showLabels=!0,this.showBootstraps=!1,this.setTreeType("radial"),this.maxBranchLength=0,this.lineWidth=1,this.textSize=7,this.font="sans-serif",this.unselectOnClickAway=!0,this.rightClickZoom=!0,this.useNavigator&&(this.navigator=new d["default"](this)),this.resizeToContainer(),this.addListener("click",this.clicked.bind(this)),this.addListener("mousedown",this.pickup.bind(this)),this.addListener("mouseup",this.drop.bind(this)),this.addListener("mouseout",this.drop.bind(this)),b(this.canvas.canvas,"mousemove",this.drag.bind(this)),b(this.canvas.canvas,"mousewheel",this.scroll.bind(this)),b(this.canvas.canvas,"DOMMouseScroll",this.scroll.bind(this)),b(window,"resize",function(){this.resizeToContainer(),this.draw()}.bind(this)),this.alignLabels=!1,this.farthestNodeFromRootX=0,this.farthestNodeFromRootY=0,this.colour1="rgba(206,16,16,1)",this.colour0="#ccc",this.maxLabelLength={}}return s(e,[{key:"setInitialCollapsedBranches",value:function(){var e,t,n=void 0===arguments[0]?this.root:arguments[0];if(e=n.getChildIds(),e&&e.length>this.defaultCollapsedOptions.min&&e.length<this.defaultCollapsedOptions.max)return void(n.collapsed=!0);for(t=0;t<n.children.length;t++)this.setInitialCollapsedBranches(n.children[t])}},{key:"clicked",value:function(e){var t;if(0===e.button){var n,a=[];if(this.dragging)return void(this.dragging=!1);if(!this.root)return!1;t=(n=this.root).clicked.apply(n,r(k(e.clientX,e.clientY,this))),t&&t.interactive?(this.root.cascadeFlag("selected",!1),(this.internalNodesSelectable||t.leaf)&&(t.cascadeFlag("selected",!0),a=t.getChildIds()),this.draw()):this.unselectOnClickAway&&!this.dragging&&(this.root.cascadeFlag("selected",!1),this.draw()),this.pickedup||(this.dragging=!1),this.nodesUpdated(a,"selected")}}},{key:"dblclicked",value:function(e){var t;if(!this.root)return!1;var n=(t=this.root).clicked.apply(t,r(k(e.clientX,e.clientY,this)));n&&(n.cascadeFlag("selected",!1),n.toggleCollapsed()),this.pickedup||(this.dragging=!1),this.draw()}},{key:"displayLabels",value:function(){this.showLabels=!0,this.draw()}},{key:"drag",value:function(e){var t=w(this.canvas);if(!this.drawn)return!1;if(this.pickedup){var n=(e.clientX-this.startx)*t,a=(e.clientY-this.starty)*t;Math.abs(n)+Math.abs(a)>5&&(this.dragging=!0,this.offsetx=this.origx+n,this.offsety=this.origy+a,this.draw())}else if(this.zoomPickedUp)this.d=(this.starty-e.clientY)/100,this.setZoom(this.origZoom+this.d),this.draw();else{var i,s=e,o=(i=this.root).clicked.apply(i,r(k(1*s.clientX,1*s.clientY,this)));o&&o.interactive&&(this.internalNodesSelectable||o.leaf)?(this.root.cascadeFlag("hovered",!1),o.hovered=!0,o.leaf||o.hasCollapsedAncestor()||this.tooltip.open(s.clientX,s.clientY,o),this.canvasEl.style.cursor="pointer"):(this.tooltip.close(),this.root.cascadeFlag("hovered",!1),this.canvasEl.style.cursor="auto"),this.draw()}}},{key:"draw",value:function(e){return this.highlighters.length=0,0===this.maxBranchLength?void this.loadError(new Error("All branches in the tree are identical.")):(this.canvas.restore(),this.canvas.clearRect(0,0,this.canvas.canvas.width,this.canvas.canvas.height),this.canvas.lineCap="round",this.canvas.lineJoin="round",this.canvas.strokeStyle=this.branchColour,this.canvas.save(),this.canvas.translate(this.canvas.canvas.width/2/x(this.canvas),this.canvas.canvas.height/2/x(this.canvas)),(!this.drawn||e)&&(this.prerenderer.run(this),e||this.fitInPanel()),this.canvas.lineWidth=this.lineWidth/this.zoom,this.canvas.translate(this.offsetx,this.offsety),this.canvas.scale(this.zoom,this.zoom),this.branchRenderer.render(this,this.root),this.highlighters.forEach(function(e){return e()}),this.defaultCollapsed=!1,void(this.drawn=!0))}},{key:"drop",value:function(){return this.drawn?(this.pickedup=!1,void(this.zoomPickedUp=!1)):!1}},{key:"findLeaves",value:function(e){var t=void 0===arguments[1]?"id":arguments[1],n=[],a=!0,r=!1,i=void 0;try{for(var s,o=this.leaves[Symbol.iterator]();!(a=(s=o.next()).done);a=!0){var l=s.value;l[t]&&l[t].match(e)&&n.push(l)}}catch(c){r=!0,i=c}finally{try{!a&&o["return"]&&o["return"]()}finally{if(r)throw i}}return n}},{key:"updateLeaves",value:function(e,t,n){var a=!0,r=!1,i=void 0;try{for(var s,o=this.leaves[Symbol.iterator]();!(a=(s=o.next()).done);a=!0){var l=s.value;l[t]=!n}}catch(c){r=!0,i=c}finally{try{!a&&o["return"]&&o["return"]()}finally{if(r)throw i}}var h=!0,u=!1,d=void 0;try{for(var f,v=e[Symbol.iterator]();!(h=(f=v.next()).done);h=!0){var l=f.value;l[t]=n}}catch(c){u=!0,d=c}finally{try{!h&&v["return"]&&v["return"]()}finally{if(u)throw d}}this.nodesUpdated(e.map(function(e){return e.id}),t)}},{key:"clearSelect",value:function(){this.root.cascadeFlag("selected",!1),this.draw()}},{key:"generateBranchId",value:function(){return"pcn"+this.lastId++}},{key:"getPngUrl",value:function(){return this.canvas.canvas.toDataURL()}},{key:"hideLabels",value:function(){this.showLabels=!1,this.draw()}},{key:"load",value:function(e,t,n){void 0===t&&(t={});var a=t,r=n;if("function"==typeof t&&(r=t,a={}),r&&(a.callback=r),a.format)return void this.build(e,g["default"][a.format],a);var i=!0,s=!1,o=void 0;try{for(var l,c=Object.keys(g["default"])[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var h=l.value,u=g["default"][h];if(e.match(u.fileExtension)||e.match(u.validator))return void this.build(e,u,a)}}catch(d){s=!0,o=d}finally{try{!i&&c["return"]&&c["return"]()}finally{if(s)throw o}}var f=new Error("String not recognised as a file or a parseable format string");r&&r(f),this.loadError(f)}},{key:"saveOriginalTree",value:function(){this.originalTree.branches=this.branches,this.originalTree.leaves=this.leaves,this.originalTree.root=this.root,this.originalTree.branchLengths={},this.originalTree.parents={}}},{key:"clearState",value:function(){this.root=!1,this.leaves=[],this.branches={},this.drawn=!1}},{key:"saveState",value:function(){return this.extractNestedBranches(),this.root.branchLength=0,this.maxBranchLength=0,this.root.setTotalLength(),0===this.maxBranchLength?void this.loadError(new Error("All branches in the tree are identical.")):void 0}},{key:"build",value:function(e,t,n){var a=this;this.originalTree={},this.clearState();var r=new c["default"];r.id="root",this.branches.root=r,this.setRoot(r),t.parse({formatString:e,root:r,options:n},function(t){return t?(n.callback&&n.callback(t),void a.loadError(t)):(a.stringRepresentation=e,a.saveState(),a.setInitialCollapsedBranches(),a.draw(),a.saveOriginalTree(),n.callback&&n.callback(),void(n.quiet||a.loadCompleted()))})}},{key:"pickup",value:function(e){return this.drawn?(this.origx=this.offsetx,this.origy=this.offsety,0===e.button&&(this.pickedup=!0),2===e.button&&this.rightClickZoom&&(this.zoomPickedUp=!0,this.origZoom=Math.log(this.zoom)/Math.log(10),this.oz=this.zoom),this.startx=e.clientX,void(this.starty=e.clientY)):!1}},{key:"redrawFromBranch",value:function(e){this.clearState(),this.resetTree(),this.originalTree.branchLengths[e.id]=e.branchLength,this.originalTree.parents[e.id]=e.parent,this.root=e,this.root.parent=!1,this.saveState(),this.draw(),this.subtreeDrawn(e.id)}},{key:"redrawOriginalTree",value:function(){var e=this;this.load(this.stringRepresentation,{quiet:!0},function(){e.originalTreeRedrawn()})}},{key:"storeNode",value:function(e){if(e.id&&""!==e.id||(e.id=this.generateBranchId()),this.branches[e.id]&&e!==this.branches[e.id]){if(e.leaf)throw new Error("Two nodes on this tree share the id "+e.id);e.id=this.generateBranchId()}this.branches[e.id]=e,e.leaf&&this.leaves.push(e)}},{key:"scroll",value:function(e){var t=this;if(e.preventDefault(),!this._zooming){var n=Math.log(this.zoom)/Math.log(10);this.setZoom(n+(e.detail<0||e.wheelDelta>0?.12:-.12)),this._zooming=!0,setTimeout(function(){t._zooming=!1},128)}}},{key:"selectNodes",value:function(e){var t,n,a,r=e;if(this.root){this.root.cascadeFlag("selected",!1),"string"==typeof e&&(r=r.split(","));for(n in this.branches)if(this.branches.hasOwnProperty(n))for(t=this.branches[n],a=0;a<r.length;a++)r[a]===t.id&&t.cascadeFlag("selected",!0);this.draw()}}},{key:"setFont",value:function(e){isNaN(e)&&(this.font=e,this.draw())}},{key:"setNodeDisplay",value:function(e,t,n){var a=this;if(e)if(this.drawn){var r=[];if(r="string"==typeof e?e.split(","):e,r.length){var i=!0,s=!1,o=void 0;try{for(var l,c=r[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var h=l.value;h in this.branches&&this.branches[h].setDisplay(t)}}catch(u){s=!0,o=u}finally{try{!i&&c["return"]&&c["return"]()}finally{if(s)throw o}}this.draw()}}else n||!function(){var n=a,r=setInterval(function(){this.drawn&&(n.setNodeColourAndShape(e,t,!0),clearInterval(r))})}()}},{key:"setNodeSize",value:function(e){this.baseNodeSize=Number(e),this.draw()}},{key:"setRoot",value:function(e){e.canvas=this.canvas,e.tree=this,this.root=e}},{key:"setTextSize",value:function(e){this.textSize=Number(e),this.draw()}},{key:"setFontSize",value:function(e){this.textSize=this.calculateFontSize?this.calculateFontSize(e):Math.min(e/2,15),this.canvas.font=this.textSize+"pt "+this.font}},{key:"setTreeType",value:function(e,t){if(!(e in v["default"]))return m(this.canvasEl,"error",{error:new Error('"'+e+'" is not a known tree-type.')});var n=this.treeType;this.treeType=e,this.branchRenderer=v["default"][e].branchRenderer,this.prerenderer=v["default"][e].prerenderer,this.labelAlign=v["default"][e].labelAlign,this.scaleCollapsedNode=v["default"][e].scaleCollapsedNode,this.calculateFontSize=v["default"][e].calculateFontSize,this.drawn&&(this.drawn=!1,this.draw()),t||this.treeTypeChanged(n,e)}},{key:"setSize",value:function(e,t){this.canvas.canvas.width=e,this.canvas.canvas.height=t,this.navigator&&this.navigator.resize(),this.adjustForPixelRatio()}},{key:"setZoom",value:function(e){if(e>-2&&2>e){var t=this.zoom;this.zoom=Math.pow(10,e),this.offsetx=this.offsetx/t*this.zoom,this.offsety=this.offsety/t*this.zoom,this.draw()}}},{key:"toggleLabels",value:function(){this.showLabels=!this.showLabels,this.draw()}},{key:"setMaxLabelLength",value:function(){var e;void 0===this.maxLabelLength[this.treeType]&&(this.maxLabelLength[this.treeType]=0);for(var t=0;t<this.leaves.length;t++)e=this.canvas.measureText(this.leaves[t].id),e.width>this.maxLabelLength[this.treeType]&&(this.maxLabelLength[this.treeType]=e.width)}},{key:"loadCompleted",value:function(){m(this.canvasEl,"loaded")}},{key:"loadStarted",value:function(){m(this.canvasEl,"loading")}},{key:"loadError",value:function(e){m(this.canvasEl,"error",{error:e})}},{key:"subtreeDrawn",value:function(e){m(this.canvasEl,"subtree",{node:e})}},{key:"originalTreeRedrawn",value:function(){m(this.canvasEl,"original-tree")}},{key:"nodesUpdated",value:function(e,t){m(this.canvasEl,"updated",{nodeIds:e,property:t})}},{key:"addListener",value:function(e,t){b(this.canvasEl,e,t)}},{key:"getBounds",value:function(){for(var e=this.root.startx,t=this.root.startx,n=this.root.starty,a=this.root.starty,r=this.leaves.length;r--;){var i=this.leaves[r].getBounds();e=Math.min(e,i.minx),t=Math.max(t,i.maxx),n=Math.min(n,i.miny),a=Math.max(a,i.maxy)}return[[e,n],[t,a]]}},{key:"fitInPanel",value:function(){var e=this.getBounds(),t=e[0][0],n=e[1][0],a=e[0][1],r=e[1][1],i=this.padding,s=[this.canvas.canvas.width-i,this.canvas.canvas.height-i];this.zoom=Math.min(s[0]/(n-t),s[1]/(r-a)),this.offsety=(r+a)*this.zoom/-2,this.offsetx=(n+t)*this.zoom/-2}},{key:"adjustForPixelRatio",value:function(){var e=w(this.canvas);this.canvas.canvas.style.height=this.canvas.canvas.height+"px",this.canvas.canvas.style.width=this.canvas.canvas.width+"px",e>1&&(this.canvas.canvas.width*=e,this.canvas.canvas.height*=e)}},{key:"treeTypeChanged",value:function(e,t){m(this.canvasEl,"typechanged",{oldType:e,newType:t})}},{key:"resetTree",value:function(){if(this.originalTree.branches){this.branches=this.originalTree.branches;var e=!0,t=!1,n=void 0;try{for(var a,r=Object.keys(this.originalTree.branchLengths)[Symbol.iterator]();!(e=(a=r.next()).done);e=!0){var i=a.value;this.branches[i].branchLength=this.originalTree.branchLengths[i],this.branches[i].parent=this.originalTree.parents[i]}}catch(s){t=!0,n=s}finally{try{!e&&r["return"]&&r["return"]()}finally{if(t)throw n}}this.leaves=this.originalTree.leaves,this.root=this.originalTree.root}}},{key:"rotateBranch",value:function(e){this.branches[e.id].rotate()}},{key:"extractNestedBranches",value:function(){this.branches={},this.leaves=[],this.storeNode(this.root),this.root.extractChildren()}},{key:"exportNwk",value:function(){var e=this.root.getNwk();return e.substr(0,e.lastIndexOf(")")+1)+";"}},{key:"resizeToContainer",value:function(){this.setSize(this.canvasEl.offsetWidth,this.canvasEl.offsetHeight)}},{key:"alignLabels",get:function(){return this.showLabels&&this.labelAlign&&this.labelAlignEnabled},set:function(e){this.labelAlignEnabled=e}}]),e}();t["default"]=S,S.prototype.on=S.prototype.addListener,e.exports=t["default"]},function(e,t,n){function a(e){this.tree=e,this.cel=document.createElement("canvas"),this.cel.id=this.tree.canvasEl.id+"Navi",this.cel.style.zIndex="100",this.cel.style.backgroundColor="#FFFFFF",this.cel.width=this.tree.canvas.canvas.width/3,this.cel.height=this.tree.canvas.canvas.height/3,this.cel.style.position="absolute",this.cel.style.bottom="0px",this.cel.style.right="0px",this.cel.style.border="1px solid #CCCCCC",this.tree.canvasEl.appendChild(this.cel),this.ctx=this.cel.getContext("2d"),this.ctx.translate(this.cel.width/2,this.cel.height/2),this.ctx.save()}a.prototype.drawFrame=function(){var e,t,n,a=this.cel.width,r=this.cel.height,i=a/2,s=r/2;this.ctx.restore(),this.ctx.save(),this.ctx.clearRect(-i,-s,a,r),this.ctx.strokeStyle="rgba(180,180,255,1)",this.tree.drawn?this.ctx.drawImage(this.img,-i,-s,this.cel.width,this.cel.height):(e=this.tree.canvas.canvas.toDataURL(),this.img=document.createElement("img"),this.img.src=e,t=this,this.img.onload=function(){t.ctx.drawImage(t.img,-i,-s,t.cel.width,t.cel.height)},this.baseOffsetx=this.tree.offsetx,this.baseOffsety=this.tree.offsety,this.baseZoom=this.tree.zoom),n=1/(this.tree.zoom/this.baseZoom),this.ctx.lineWidth=this.ctx.lineWidth/n,this.ctx.translate((this.baseOffsetx-this.tree.offsetx*n)*n,(this.baseOffsety-this.tree.offsety*n)*n),this.ctx.scale(n,n),this.ctx.strokeRect(-i,-s,a,r)},a.prototype.resize=function(){this.cel.width=this.tree.canvas.canvas.width/3,this.cel.height=this.tree.canvas.canvas.height/3,this.ctx.translate(this.cel.width/2,this.cel.height/2),this.drawFrame()},e.exports=a},function(e,t,n){!function(t,n){e.exports=n()}(this,function(){return function(e){function t(a){if(n[a])return n[a].exports;var r=n[a]={exports:{},id:a,loaded:!1};return e[a].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=a(r),s=n(4),o=a(s),l=n(2),c=a(l),h=n(3),u=a(h);t["default"]={canvas:i,constants:o,dom:c,events:u},e.exports=t["default"]},function(e,t,n){function a(e){return e.backingStorePixelRatio||e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||1}function r(e){return(window.devicePixelRatio||1)/a(e)}function i(e){return e=e-l.getX(this.canvas.canvas)+window.pageXOffset,e*=r(this.canvas),e-=this.canvas.canvas.width/2,e-=this.offsetx,e/=this.zoom}function s(e){return e=e-l.getY(this.canvas.canvas)+window.pageYOffset,e*=r(this.canvas),e-=this.canvas.canvas.height/2,e-=this.offsety,e/=this.zoom}function o(e,t,n){return[i.call(n,e),s.call(n,t)]}Object.defineProperty(t,"__esModule",{value:!0}),t.getBackingStorePixelRatio=a,t.getPixelRatio=r,t.translateClick=o;var l=n(2)},function(e,t,n){function a(e){var t=new Blob([e],{type:"text/csv;charset=utf-8"});return u.createObjectURL(t)}function r(e,t){var n=document.createElement("a"),a="undefined"!=typeof n.download;n.href=e,n.target="_blank",a&&(n.download=t),h.fireEvent(n,"click"),a&&u.revokeObjectURL(n.href)}function i(e){for(var t=0;e;)t+=e.offsetLeft,e=e.offsetParent;return t}function s(e){for(var t=0;e;)t+=e.offsetTop,e=e.offsetParent;return t}function o(e,t){var n=e.className.split(" ");-1===n.indexOf(t)&&(n.push(t),e.className=n.join(" "))}function l(e,t){var n=e.className.split(" "),a=n.indexOf(t);-1!==a&&(n.splice(a,1),e.className=n.join(" "))}function c(e,t){var n=e.className.split(" "),a=n.indexOf(t);return-1!==a}Object.defineProperty(t,"__esModule",{value:!0}),t.createBlobUrl=a,t.setupDownloadLink=r,t.getX=i,t.getY=s,t.addClass=o,t.removeClass=l,t.hasClass=c;var h=n(3),u=window.URL||window.webkitURL},function(e,t){function n(e){return e.preventDefault(),!1}function a(e,t){var n,a,r=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];document.createEvent?(n=document.createEvent("HTMLEvents"),n.initEvent(t,!0,!0)):(n=document.createEventObject(),n.eventType=t),n.eventName=t;for(a in r)r.hasOwnProperty(a)&&(n[a]=r[a]);document.createEvent?e.dispatchEvent(n):e.fireEvent("on"+n.eventType,n)}function r(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent("on"+t,function(){return n.call(e,window.event)})}function i(e){e.stopPropagation(),e.preventDefault()}function s(e,t){var n;return n="string"==typeof t?function(n){return e[t]?e[t](n):void 0}:function(){return t(e)}}Object.defineProperty(t,"__esModule",{value:!0}),t.preventDefault=n,t.fireEvent=a,t.addEvent=r,t.killEvent=i,t.createHandler=s},function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n={FORTYFIVE:Math.PI/4,QUARTER:Math.PI/2,HALF:Math.PI,FULL:2*Math.PI};t.Angles=n;var a={x:"star",s:"square",o:"circle",t:"triangle"};t.Shapes=a}])})},function(e,t,n){function a(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),s=n(4),o=n(6),l=a(o),c=s.constants.Angles,h=s.constants.Shapes,u=s.dom.createBlobUrl,d={minx:0,maxx:0,miny:0,maxy:0},f=function(){function e(){r(this,e),this.angle=0,this.branchLength=!1,this.canvas=null,this.centerx=0,this.centery=0,this.children=[],this.collapsed=!1,this.colour="rgba(0,0,0,1)",this.data={},this.highlighted=!1,this.hovered=!1,this.id="",this.interx=0,this.intery=0,this.label=null,this.leaf=!0,this.maxChildAngle=0,this.minChildAngle=c.FULL,this.nodeShape="circle",this.parent=null,this.radius=1,this.selected=!1,this.startx=0,this.starty=0,this.totalBranchLength=0,this.tree={},this.pruned=!1,this.labelStyle={},this.interactive=!0}return i(e,[{key:"clicked",value:function(e,t){var n,a;if(!this.dragging){if(e<this.maxx&&e>this.minx&&t<this.maxy&&t>this.miny)return this;for(n=this.children.length-1;n>=0;n--)if(a=this.children[n].clicked(e,t))return a}}},{key:"drawLabel",value:function(){var e=this.getTextSize(),t=this.getLabel();this.canvas.font=this.getFontString(),this.labelWidth=this.canvas.measureText(t).width,void 0===this.tree.maxLabelLength[this.tree.treeType]&&(this.tree.maxLabelLength[this.tree.treeType]=0),this.labelWidth>this.tree.maxLabelLength[this.tree.treeType]&&(this.tree.maxLabelLength[this.tree.treeType]=this.labelWidth);var n=this.getLabelStartX();this.tree.alignLabels&&(n+=Math.abs(this.tree.labelAlign.getLabelOffset(this))),this.angle>c.QUARTER&&this.angle<c.HALF+c.QUARTER&&(this.canvas.rotate(c.HALF),n=-n-1*this.labelWidth),this.canvas.beginPath(),this.canvas.fillStyle=this.getTextColour(),this.canvas.fillText(t,n,e/2),this.canvas.closePath(),this.angle>c.QUARTER&&this.angle<c.HALF+c.QUARTER&&this.canvas.rotate(c.HALF)}},{key:"setNodeDimensions",value:function(e,t,n){var a=n;(n*this.tree.zoom<5||!this.leaf)&&(a=5/this.tree.zoom),this.minx=e-a,this.maxx=e+a,this.miny=t-a,this.maxy=t+a}},{key:"drawCollapsed",value:function(e,t){var n=this.getChildIds(),a=n.length;this.tree.scaleCollapsedNode&&(a=this.tree.scaleCollapsedNode(a)),this.canvas.globalAlpha=.3,this.canvas.beginPath(),this.canvas.arc(e,t,a,0,2*Math.PI,!1),this.canvas.fillStyle=this.tree.defaultCollapsedOptions.color?this.tree.defaultCollapsedOptions.color:"purple",this.canvas.fill(),this.canvas.globalAlpha=1,this.canvas.closePath()}},{key:"drawLabelConnector",value:function(){var e=this.canvas.lineWidth,t=this.tree.labelAlign;this.canvas.lineWidth=this.canvas.lineWidth/4,this.canvas.strokeStyle=this.isHighlighted?this.tree.highlightColour:this.getColour(),this.canvas.beginPath(),this.canvas.moveTo(this.getRadius(),0),this.canvas.lineTo(t.getLabelOffset(this)+this.getDiameter(),0),this.canvas.stroke(),this.canvas.closePath(),this.canvas.strokeStyle=this.getColour(),this.canvas.lineWidth=e}},{key:"drawLeaf",value:function(){this.tree.alignLabels&&this.drawLabelConnector(),l["default"][this.nodeShape](this),(this.tree.showLabels||this.tree.hoverLabel&&this.isHighlighted)&&this.drawLabel()}},{key:"drawHighlight",value:function(e,t){this.canvas.beginPath();var n=this.canvas.lineWidth;this.canvas.strokeStyle=this.tree.highlightColour,this.canvas.lineWidth=this.getHighlightLineWidth();var a=this.getHighlightRadius();this.canvas.arc(e,t,a,0,c.FULL,!1),this.canvas.stroke(),this.canvas.lineWidth=n,this.canvas.strokeStyle=this.tree.branchColour,this.canvas.closePath()}},{key:"drawNode",value:function(){var e=this.getRadius(),t=e,n=this.leaf?t*Math.cos(this.angle)+this.centerx:this.centerx,a=this.leaf?t*Math.sin(this.angle)+this.centery:this.centery;this.canvas.fillStyle=this.selected?this.tree.selectedColour:this.colour,this.setNodeDimensions(n,a,e),this.collapsed?this.drawCollapsed(n,a):this.leaf&&(this.canvas.save(),this.canvas.translate(this.centerx,this.centery),this.canvas.rotate(this.angle),this.drawLeaf(),this.canvas.restore()),this.isHighlighted&&this.tree.highlighters.push(this.drawHighlight.bind(this,n,a))}},{key:"getChildIds",value:function(){var e,t=[];if(this.leaf)return[this.id];for(t=[],e=0;e<this.children.length;e++)t=t.concat(this.children[e].getChildIds());return t}},{key:"getChildCount",value:function(){var e,t=0;if(this.leaf)return 1;for(e=0;e<this.children.length;e++)t+=this.children[e].getChildCount();return t}},{key:"getChildYTotal",value:function(){var e,t=0;if(this.leaf)return this.centery;for(e=0;e<this.children.length;e++)t+=this.children[e].getChildYTotal();return t}},{key:"cascadeFlag",value:function(e,t){if("undefined"==typeof this[e])throw new Error("Unknown property: "+e);this[e]=t;var n=!0,a=!1,r=void 0;try{for(var i,s=this.children[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){var o=i.value;o.cascadeFlag(e,t)}}catch(l){a=!0,r=l}finally{try{!n&&s["return"]&&s["return"]()}finally{if(a)throw r}}}},{key:"reset",value:function(){var e,t;for(this.startx=0,this.starty=0,this.centerx=0,this.centery=0,this.angle=null,this.minChildAngle=c.FULL,this.maxChildAngle=0,t=0;t<this.children.length;t++)try{this.children[e].pcReset()}catch(n){return n}}},{key:"redrawTreeFromBranch",value:function(){this.tree.redrawFromBranch(this)}},{key:"extractChildren",value:function(){var e=!0,t=!1,n=void 0;try{for(var a,r=this.children[Symbol.iterator]();!(e=(a=r.next()).done);e=!0){var i=a.value;this.tree.storeNode(i),i.extractChildren()}}catch(s){t=!0,n=s}finally{try{!e&&r["return"]&&r["return"]()}finally{if(t)throw n}}}},{key:"hasCollapsedAncestor",value:function(){return this.parent?this.parent.collapsed||this.parent.hasCollapsedAncestor():!1}},{key:"collapse",value:function(){this.collapsed=this.leaf===!1}},{key:"expand",value:function(){this.collapsed=!1}},{key:"toggleCollapsed",value:function(){this.collapsed?this.expand():this.collapse()}},{key:"setTotalLength",value:function(){var e;for(this.parent?(this.totalBranchLength=this.parent.totalBranchLength+this.branchLength,this.totalBranchLength>this.tree.maxBranchLength&&(this.tree.maxBranchLength=this.totalBranchLength)):(this.totalBranchLength=this.branchLength,this.tree.maxBranchLength=this.totalBranchLength),e=0;e<this.children.length;e++)this.children[e].setTotalLength()}},{key:"addChild",value:function(e){e.parent=this,e.canvas=this.canvas,e.tree=this.tree,this.leaf=!1,this.children.push(e)}},{key:"getChildColours",value:function(){var e=[];return this.children.forEach(function(t){var n=0===t.children.length?t.colour:t.getColour();-1===e.indexOf(n)&&e.push(n)}),e}},{key:"getColour",value:function(){var e;return this.selected?this.tree.selectedColour:this.tree.backColour===!0?this.children.length?(e=this.getChildColours(),1===e.length?e[0]:this.tree.branchColour):this.colour:"function"==typeof this.tree.backColour?this.tree.backColour(this):this.tree.branchColour}},{key:"getNwk",value:function(){var e,t,n;if(this.leaf)return this.id+":"+this.branchLength;for(e=[],t=0;t<this.children.length;t++)e.push(this.children[t].getNwk());return n="("+e.join(",")+"):"+this.branchLength}},{key:"getTextColour",value:function(){if(this.selected)return this.tree.selectedColour;if(this.isHighlighted)return this.tree.highlightColour;if(this.tree.backColour&&this.children.length){var e=this.getChildColours();if(1===e.length)return e[0]}return this.labelStyle.colour||this.colour||this.tree.branchColour}},{key:"getLabel",value:function(){return void 0!==this.label&&null!==this.label?this.label:""}},{key:"getTextSize",value:function(){return this.labelStyle.textSize||this.tree.textSize;
}},{key:"getFontString",value:function(){var e=this.labelStyle.font||this.tree.font;return(this.labelStyle.format||"")+" "+this.getTextSize()+"pt "+e}},{key:"getLabelSize",value:function(){return this.canvas.font=this.getFontString(),this.canvas.measureText(this.getLabel()).width}},{key:"getRadius",value:function(){return this.leaf?this.tree.baseNodeSize*this.radius:this.tree.baseNodeSize/this.radius}},{key:"getDiameter",value:function(){return 2*this.getRadius()}},{key:"hasLabelConnector",value:function(){return this.tree.alignLabels?this.tree.labelAlign.getLabelOffset(this)>this.getDiameter():!1}},{key:"getLabelStartX",value:function(){var e=this.getDiameter();return this.isHighlighted&&!this.hasLabelConnector()&&(e+=this.getHighlightSize()-this.getRadius()),e+Math.min(this.tree.labelPadding,this.tree.labelPadding/this.tree.zoom)}},{key:"getHighlightLineWidth",value:function(){return this.tree.highlightWidth/this.tree.zoom}},{key:"getHighlightRadius",value:function(){var e=this.getHighlightLineWidth()*this.tree.highlightSize;return this.leaf?this.getRadius()+e:.666*e}},{key:"getHighlightSize",value:function(){return this.getHighlightRadius()+this.getHighlightLineWidth()}},{key:"rotate",value:function(e){var t,n=[];for(t=this.children.length;t--;)n.push(this.children[t]);this.children=n,e.preventredraw||(this.tree.extractNestedBranches(),this.tree.draw(!0))}},{key:"getChildNo",value:function(){return this.parent.children.indexOf(this)}},{key:"downloadLeafIdsFromBranch",value:function(){var e=this.getChildIds().join("\n"),t="pc_leaf_ids";return t+=this.parent?"_"+this.id+".txt":"_all.txt",u(e)}},{key:"setDisplay",value:function(e){var t=e.colour,n=e.shape,a=e.size;t&&(this.colour=t),n&&(this.nodeShape=h[n]?h[n]:n),a&&(this.radius=a)}},{key:"getTotalLength",value:function(){var e=this.getRadius();return(this.tree.showLabels||this.tree.hoverLabel&&this.isHighlighted)&&(e+=this.getLabelStartX()+this.getLabelSize()),e}},{key:"getBounds",value:function(){var e=this.tree,t=e.alignLabels?e.labelAlign.getX(this):this.centerx,n=e.alignLabels?e.labelAlign.getY(this):this.centery,a=this.getRadius(),r=this.getTotalLength(),i=void 0,s=void 0,o=void 0,l=void 0;return this.angle>c.QUARTER&&this.angle<c.HALF+c.QUARTER?(i=t+r*Math.cos(this.angle),o=n+r*Math.sin(this.angle),s=t-a,l=n-a):(i=t-a,o=n-a,s=t+r*Math.cos(this.angle),l=n+r*Math.sin(this.angle)),d.minx=Math.min(i,s,t-this.getHighlightSize()),d.miny=Math.min(o,l,n-this.getHighlightSize()),d.maxx=Math.max(i,s,t+this.getHighlightSize()),d.maxy=Math.max(o,l,n+this.getHighlightSize()),d}},{key:"isHighlighted",get:function(){return this.highlighted||this.hovered}}]),e}();t["default"]=f,e.exports=t["default"]},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var a=n(4),r=a.constants.Angles;t["default"]={circle:function(e){var t=e.getRadius();e.canvas.beginPath(),e.canvas.arc(t,0,t,0,r.FULL,!1),e.canvas.stroke(),e.canvas.fill(),e.canvas.closePath()},square:function(e){var t=e.getRadius(),n=0,a=2*t,r=-t,i=t;e.canvas.beginPath(),e.canvas.moveTo(n,r),e.canvas.lineTo(n,i),e.canvas.lineTo(a,i),e.canvas.lineTo(a,r),e.canvas.lineTo(n,r),e.canvas.stroke(),e.canvas.fill(),e.canvas.closePath()},star:function(e){var t=e.getRadius(),n=t,a=0,r=8,i=t,s=.5*t,o=Math.PI/2*3,l=n,c=a,h=Math.PI/r,u=0;for(e.canvas.beginPath(),e.canvas.moveTo(n,a-i),u=0;r>u;u++)l=n+Math.cos(o)*i,c=a+Math.sin(o)*i,e.canvas.lineTo(l,c),o+=h,l=n+Math.cos(o)*s,c=a+Math.sin(o)*s,e.canvas.lineTo(l,c),o+=h;e.canvas.lineTo(n,a-i),e.canvas.stroke(),e.canvas.fill(),e.canvas.closePath()},triangle:function(e){var t=e.getRadius(),n=2*t*Math.cos(30*Math.PI/180);e.canvas.beginPath(),e.canvas.moveTo(0,0),e.canvas.rotate(30*Math.PI/180),e.canvas.lineTo(n,0),e.canvas.rotate(-60*Math.PI/180),e.canvas.lineTo(n,0),e.canvas.rotate(30*Math.PI/180),e.canvas.lineTo(0,0),e.canvas.stroke(),e.canvas.fill(),e.canvas.closePath()}},e.exports=t["default"]},function(e,t,n){function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(e,t,n){for(var a=!0;a;){var r=e,i=t,s=n;o=c=l=void 0,a=!1,null===r&&(r=Function.prototype);var o=Object.getOwnPropertyDescriptor(r,i);if(void 0!==o){if("value"in o)return o.value;var l=o.get;return void 0===l?void 0:l.call(s)}var c=Object.getPrototypeOf(r);if(null===c)return void 0;e=c,t=i,n=s,a=!0}},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(){function e(t){var n=void 0===arguments[1]?{}:arguments[1],a=n.className,i=void 0===a?"phylocanvas-tooltip":a,s=n.element,o=void 0===s?document.createElement("div"):s,l=n.zIndex,c=void 0===l?2e3:l;r(this,e),this.tree=t,this.element=o,this.element.className=i,this.element.style.display="none",this.element.style.position="fixed",this.element.style.zIndex=c,this.closed=!0,this.tree.canvasEl.appendChild(this.element)}return s(e,[{key:"close",value:function(){this.element.style.display="none",this.closed=!0}},{key:"open",value:function(e,t,n){for(void 0===e&&(e=100),void 0===t&&(t=100);this.element.hasChildNodes();)this.element.removeChild(this.element.firstChild);this.createContent(n),this.element.style.top=t+"px",this.element.style.left=e+"px",this.element.style.display="block",this.closed=!1}}]),e}();t["default"]=o;var l=function(e){function t(e,n){r(this,t),i(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,n),this.element.style.background="rgba(97, 97, 97, 0.9)",this.element.style.color="#fff",this.element.style.cursor="pointer",this.element.style.padding="8px",this.element.style.marginTop="16px",this.element.style.borderRadius="2px",this.element.style.textAlign="center",this.element.style.fontFamily=this.tree.font||"sans-serif",this.element.style.fontSize="10px",this.element.style.fontWeight="500"}return a(t,e),s(t,[{key:"createContent",value:function(e){var t=document.createTextNode(e.getChildIds().length);this.element.appendChild(t)}}]),t}(o);t.ChildNodesTooltip=l},function(e,t,n){function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(9),i=a(r),s=n(14),o=a(s),l=n(17),c=a(l),h=n(20),u=a(h),d=n(23),f=a(d);t["default"]={rectangular:i["default"],circular:o["default"],radial:c["default"],diagonal:u["default"],hierarchical:f["default"]},e.exports=t["default"]},function(e,t,n){function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(10),i=a(r),s=n(11),o=a(s),l=n(12),c=a(l),h=n(13),u=a(h),d={getX:function(e){return e.tree.farthestNodeFromRootX},getY:function(e){return e.centery},getLabelOffset:function(e){return e.tree.farthestNodeFromRootX-e.centerx}};t["default"]={branchRenderer:new i["default"](c["default"]),prerenderer:new o["default"](u["default"]),labelAlign:d},e.exports=t["default"]},function(e,t,n){function a(e){if(!e||!e.draw)throw new Error("`draw` function is required for branch renderers");this.draw=e.draw,this.prepareChild=e.prepareChild}a.prototype.render=function(e,t,n){var a;if(!n&&t&&(t.selected?t.canvas.fillStyle=e.selectedColour:t.canvas.fillStyle=t.colour,t.canvas.strokeStyle=t.getColour(),this.draw(e,t),!t.pruned))for(t.drawNode(),a=0;a<t.children.length;a++)this.prepareChild&&this.prepareChild(t,t.children[a]),this.render(e,t.children[a],t.collapsed||n)},e.exports=a},function(e,t,n){function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=function(){function e(t){a(this,e),this.getStep=t.getStep,this.calculate=t.calculate}return r(e,[{key:"run",value:function(e){var t=this.getStep(e);e.root.startx=0,e.root.starty=0,e.root.centerx=0,e.root.centery=0,e.farthestNodeFromRootX=0,e.farthestNodeFromRootY=0,this.calculate(e,t),e.root.startx=e.root.centerx,e.root.starty=e.root.centery,e.setFontSize(t),e.setMaxLabelLength()}}]),e}();t["default"]=i,e.exports=t["default"]},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={draw:function(e,t){var n=t.branchLength*e.branchScalar;t.angle=0,t.parent&&(t.centerx=t.startx+n),t.canvas.beginPath(),t.canvas.moveTo(t.startx,t.starty),t.canvas.lineTo(t.startx,t.centery),t.canvas.lineTo(t.centerx,t.centery),t.canvas.stroke(),t.canvas.closePath()},prepareChild:function(e,t){t.startx=e.centerx,t.starty=e.centery}},e.exports=t["default"]},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={getStep:function(e){return Math.max(e.canvas.canvas.height/e.leaves.length,e.leaves[0].getDiameter()+e.labelPadding)},calculate:function(e,t){e.branchScalar=e.canvas.canvas.width/e.maxBranchLength;for(var n=0;n<e.leaves.length;n++){e.leaves[n].angle=0,e.leaves[n].centery=n>0?e.leaves[n-1].centery+t:0,e.leaves[n].centerx=e.leaves[n].totalBranchLength*e.branchScalar,e.leaves[n].centerx>e.farthestNodeFromRootX&&(e.farthestNodeFromRootX=e.leaves[n].centerx),e.leaves[n].centery>e.farthestNodeFromRootY&&(e.farthestNodeFromRootY=e.leaves[n].centery);for(var a=e.leaves[n];a.parent;a=a.parent){var r=a.parent.children;a.parent.centery=(r[0].centery+r[r.length-1].centery)/2}}}},e.exports=t["default"]},function(e,t,n){function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(10),i=a(r),s=n(11),o=a(s),l=n(15),c=a(l),h=n(16),u=a(h),d={getX:function(e){return e.centerx+e.labelOffsetX+e.getDiameter()*Math.cos(e.angle)},getY:function(e){return e.centery+e.labelOffsetY+e.getDiameter()*Math.sin(e.angle)},getLabelOffset:function(e){return e.labelOffsetX/Math.cos(e.angle)}};t["default"]={branchRenderer:new i["default"](c["default"]),prerenderer:new o["default"](u["default"]),labelAlign:d,scaleCollapsedNode:function(e){return e/3},calculateFontSize:function(e){return Math.min(10*e+4,40)}},e.exports=t["default"]},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={draw:function(e,t){var n=t.totalBranchLength*e.branchScalar;t.canvas.beginPath(),t.canvas.moveTo(t.startx,t.starty),t.canvas.lineTo(t.centerx,t.centery),t.canvas.stroke(),t.canvas.closePath(),t.canvas.strokeStyle=t.getColour(),t.children.length>1&&!t.collapsed&&(t.canvas.beginPath(),t.canvas.arc(0,0,n,t.minChildAngle,t.maxChildAngle,t.maxChildAngle<t.minChildAngle),t.canvas.stroke(),t.canvas.closePath())}},e.exports=t["default"]},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var a=n(4),r=a.constants.Angles;t["default"]={getStep:function(e){return r.FULL/e.leaves.length},calculate:function(e,t){e.branchScalar=Math.min(e.canvas.canvas.width,e.canvas.canvas.height)/e.maxBranchLength;var n=e.leaves.length*e.leaves[0].getDiameter()/r.FULL;e.branchScalar*e.maxBranchLength>n?n=e.branchScalar*e.maxBranchLength:e.branchScalar=n/e.maxBranchLength;for(var a=0;a<e.leaves.length;a++){var i=e.leaves[a];for(i.angle=t*a,i.startx=i.parent.totalBranchLength*e.branchScalar*Math.cos(i.angle),i.starty=i.parent.totalBranchLength*e.branchScalar*Math.sin(i.angle),i.centerx=i.totalBranchLength*e.branchScalar*Math.cos(i.angle),i.centery=i.totalBranchLength*e.branchScalar*Math.sin(i.angle),i.labelOffsetX=n*Math.cos(i.angle)-i.centerx,i.labelOffsetY=n*Math.sin(i.angle)-i.centery;i.parent&&(0===i.getChildNo()&&(i.parent.angle=i.angle,i.parent.minChildAngle=i.angle),i.getChildNo()===i.parent.children.length-1);i=i.parent)i.parent.maxChildAngle=i.angle,i.parent.angle=(i.parent.minChildAngle+i.parent.maxChildAngle)/2,i.parent.startx=(i.parent.totalBranchLength-i.parent.branchLength)*e.branchScalar*Math.cos(i.parent.angle),i.parent.starty=(i.parent.totalBranchLength-i.parent.branchLength)*e.branchScalar*Math.sin(i.parent.angle),i.parent.centerx=i.parent.totalBranchLength*e.branchScalar*Math.cos(i.parent.angle),i.parent.centery=i.parent.totalBranchLength*e.branchScalar*Math.sin(i.parent.angle)}}},e.exports=t["default"]},function(e,t,n){function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(10),i=a(r),s=n(11),o=a(s),l=n(18),c=a(l),h=n(19),u=a(h);t["default"]={branchRenderer:new i["default"](c["default"]),prerenderer:new o["default"](u["default"]),scaleCollapsedNode:function(e){return e/7},calculateFontSize:function(e){return Math.min(50*e+5,15)}},e.exports=t["default"]},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={draw:function(e,t){t.canvas.beginPath(),t.canvas.moveTo(t.startx,t.starty),t.canvas.lineTo(t.centerx,t.centery),t.canvas.stroke(),t.canvas.closePath()}},e.exports=t["default"]},function(e,t,n){function a(e,t){t.parent?(t.startx=t.parent.centerx,t.starty=t.parent.centery):(t.startx=0,t.starty=0),t.centerx=t.startx+t.branchLength*e.branchScalar*Math.cos(t.angle),t.centery=t.starty+t.branchLength*e.branchScalar*Math.sin(t.angle);for(var n=0;n<t.children.length;n++)a(e,t.children[n])}Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),i=r.constants.Angles;t["default"]={getStep:function(e){return i.FULL/e.leaves.length},calculate:function(e,t){e.branchScalar=Math.min(e.canvas.canvas.width,e.canvas.canvas.height)/e.maxBranchLength;for(var n=0;n<e.leaves.length;n+=1){e.leaves[n].angle=t*n,e.leaves[n].centerx=e.leaves[n].totalBranchLength*e.branchScalar*Math.cos(e.leaves[n].angle),e.leaves[n].centery=e.leaves[n].totalBranchLength*e.branchScalar*Math.sin(e.leaves[n].angle);for(var r=e.leaves[n];r.parent&&(0===r.getChildNo()&&(r.parent.angle=0),r.parent.angle+=r.angle*r.getChildCount(),r.getChildNo()===r.parent.children.length-1);r=r.parent)r.parent.angle=r.parent.angle/r.parent.getChildCount()}a(e,e.root)}},e.exports=t["default"]},function(e,t,n){function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(10),i=a(r),s=n(11),o=a(s),l=n(21),c=a(l),h=n(22),u=a(h);t["default"]={branchRenderer:new i["default"](c["default"]),prerenderer:new o["default"](u["default"]),calculateFontSize:function(e){return Math.min(e/2,10)}},e.exports=t["default"]},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={draw:function(e,t){t.angle=0,t.canvas.beginPath(),t.canvas.moveTo(t.startx,t.starty),t.canvas.lineTo(t.centerx,t.centery),t.canvas.stroke(),t.canvas.closePath()},prepareChild:function(e,t){t.startx=e.centerx,t.starty=e.centery}},e.exports=t["default"]},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var a=n(4),r=a.constants.Angles;t["default"]={getStep:function(e){return Math.max(e.canvas.canvas.height/e.leaves.length,e.leaves[0].getDiameter()+e.labelPadding)},calculate:function(e,t){for(var n=0;n<e.leaves.length;n++){e.leaves[n].centerx=0,e.leaves[n].centery=n>0?e.leaves[n-1].centery+t:0,e.leaves[n].angle=0;for(var a=e.leaves[n];a.parent&&a.getChildNo()===a.parent.children.length-1;a=a.parent){a.parent.centery=a.parent.getChildYTotal()/a.parent.getChildCount(),a.parent.centerx=a.parent.children[0].centerx+(a.parent.children[0].centery-a.parent.centery)*Math.tan(r.FORTYFIVE);for(var i=0;i<a.parent.children.length;i++)a.parent.children[i].startx=a.parent.centerx,a.parent.children[i].starty=a.parent.centery}}}},e.exports=t["default"]},function(e,t,n){function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(10),i=a(r),s=n(11),o=a(s),l=n(24),c=a(l),h=n(25),u=a(h),d={getX:function(e){return e.centerx},getY:function(e){return e.tree.farthestNodeFromRootY},getLabelOffset:function(e){return e.tree.farthestNodeFromRootY-e.centery}};t["default"]={branchRenderer:new i["default"](c["default"]),prerenderer:new o["default"](u["default"]),labelAlign:d},e.exports=t["default"]},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={draw:function(e,t){t.canvas.beginPath(),t!==t.tree.root&&(t.canvas.moveTo(t.startx,t.starty),t.canvas.lineTo(t.centerx,t.starty)),t.canvas.lineTo(t.centerx,t.centery),t.canvas.stroke(),t.canvas.closePath()}},e.exports=t["default"]},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var a=n(4),r=a.constants.Angles;t["default"]={getStep:function(e){return Math.max(e.canvas.canvas.width/e.leaves.length,e.leaves[0].getDiameter()+e.labelPadding)},calculate:function(e,t){e.branchScalar=e.canvas.canvas.height/e.maxBranchLength;for(var n=0;n<e.leaves.length;n++){e.leaves[n].angle=r.QUARTER,e.leaves[n].centerx=n>0?e.leaves[n-1].centerx+t:0,e.leaves[n].centery=e.leaves[n].totalBranchLength*e.branchScalar;for(var a=e.leaves[n];a.parent&&(0===a.getChildNo()&&(a.parent.centerx=a.centerx),a.getChildNo()===a.parent.children.length-1);a=a.parent){a.parent.angle=r.QUARTER,a.parent.centerx=(a.parent.centerx+a.centerx)/2,a.parent.centery=a.parent.totalBranchLength*e.branchScalar;for(var i=0;i<a.parent.children.length;i++)a.parent.children[i].startx=a.parent.centerx,a.parent.children[i].starty=a.parent.centery}e.leaves[n].centerx>e.farthestNodeFromRootX&&(e.farthestNodeFromRootX=e.leaves[n].centerx),e.leaves[n].centery>e.farthestNodeFromRootY&&(e.farthestNodeFromRootY=e.leaves[n].centery)}}},e.exports=t["default"]},function(e,t,n){function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=a(r),s=n(27),o=a(s),l=n(28),c=a(l);t["default"]={nexus:new i["default"](c["default"]),newick:new i["default"](o["default"])},e.exports=t["default"]},function(e,t,n){function a(e){return e&&e.__esModule?e:{"default":e}}function r(e){return this===e}function i(e){var t="",n=!0,a=!1,i=void 0;try{for(var s,o=e[Symbol.iterator]();!(n=(s=o.next()).done);n=!0){var l=s.value;if(p.some(r.bind(l)))break;t+=l}}catch(c){a=!0,i=c}finally{try{!n&&o["return"]&&o["return"]()}finally{if(a)throw i}}return t}function s(e,t){var n=e.split("**"),a={};if(t.id=n[0],1!==n.length){n=n[1].split("*");for(var r=0;r<n.length;r+=2){var i=n[r+1];switch(n[r]){case"nsz":a.size=window.parseInt(i);break;case"nsh":a.shape=i;break;case"ncol":a.colour=i}}t.setDisplay(a)}}function o(e){var t="",n=!0,a=!1,i=void 0;try{for(var s,o=e[Symbol.iterator]();!(n=(s=o.next()).done);n=!0){var l=s.value;if(g.some(r.bind(l)))break;t+=l}}catch(c){a=!0,i=c}finally{try{!n&&o["return"]&&o["return"]()}finally{if(a)throw i}}return t}function l(e,t,n){var a=i(t.slice(n)),r=n+a.length,l="";return a.match(/\*/)&&s(a,e),":"===t[r]?(l=o(t.slice(r+1)),e.branchLength=Math.max(parseFloat(l),0)):e.branchLength=0,a&&(e.label=a),e.id=a||e.tree.generateBranchId(),r+l.length}function c(e,t){for(var n=e.string,a=e.root,r=n.replace(/(\r|\n)/g,""),i=a,s=0;s<r.length;s++){var o=void 0;switch(r[s]){case"(":o=new u["default"],i.addChild(o),i=o;break;case")":i=i.parent;break;case",":o=new u["default"],i.parent.addChild(o),i=o;break;case";":break;default:try{s=l(i,r,s)}catch(c){return t(c)}}}return t()}Object.defineProperty(t,"__esModule",{value:!0});var h=n(5),u=a(h),d="newick",f=/\.nwk$/,v=/^[\w\W\.\*\:(\),-\/]+;\s?$/gi,p=[":",",",")",";"],g=[")",",",";"];t["default"]={format:d,fileExtension:f,validator:v,parseFn:c},e.exports=t["default"]},function(e,t,n){function a(e,t){var n=e.string,a=e.root,i=e.options;if(!n.match(/BEGIN TREES/gi))return t(new Error("The nexus file does not contain a tree block"));var s=i.name,o=n.match(/BEGIN TREES;[\S\s]+END;/i)[0].replace(/BEGIN TREES;\n/i,"").replace(/END;/i,""),l={},c=o.match(/TRANSLATE[^;]+;/i);if(c&&c.length){c=c[0],o=o.replace(c,""),c=c.replace(/translate|;/gi,"");for(var h=c.split(","),u=0;u<h.length;u++){var d=h[u].trim().replace("\n","").split(" ");d[0]&&d[1]&&(l[d[0].trim()]=d[1].trim())}}for(var f=o.split("\n"),v={},u=0;u<f.length;u++)if(""!==f[u].trim()){var p=f[u].replace(/tree\s/i,"");s||(s=p.trim().match(/^\w+/)[0]),v[s]=p.trim().match(/[\S]*$/)[0]}return v[s]?void r.parseFn({string:v[s].trim(),root:a},function(e){if(e)return t(e);if(t(),l){var n=!0,r=!1,i=void 0;try{for(var s,o=Object.keys(l)[Symbol.iterator]();!(n=(s=o.next()).done);n=!0){var c=s.value,h=a.tree.branches,u=h[c];delete h[c],u.id=l[c],h[u.id]=u}}catch(d){r=!0,i=d}finally{try{!n&&o["return"]&&o["return"]()}finally{if(r)throw i}}a.tree.draw()}}):new Error("tree "+s+" does not exist in this NEXUS file")}Object.defineProperty(t,"__esModule",{value:!0});var r=n(27),i="nexus",s=/\.n(ex|xs)$/,o=/^#NEXUS[\s\n;\w\W\.\*\:(\),-=\[\]\/&]+$/i;t["default"]={parseFn:a,format:i,fileExtension:s,validator:o},e.exports=t["default"]}])})},function(e,t){"use strict";!function(e){function t(a){if(n[a])return n[a].exports;var r=n[a]={exports:{},id:a,loaded:!1};return e[a].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){n(1),n(30),n(38),n(42)},function(e,t,n){var a=n(8),r=n(10),i=n(18),s=n(22),o=n(2),l=n(25),c=n(27);r(r.S+r.F*!n(29)(function(e){Array.from(e)}),"Array",{from:function(e){var t,n,r,h,u=i(e,!0),d="function"==typeof this?this:Array,f=arguments[1],v=void 0!==f,p=0,g=c(u);if(v&&(f=a(f,arguments[2],2)),void 0==g||d==Array&&o(g))for(n=new d(t=l(u.length));t>p;p++)n[p]=v?f(u[p],p):u[p];else for(h=g.call(u),n=new d;!(r=h.next()).done;p++)n[p]=v?s(h,f,[r.value,p],!0):r.value;return n.length=p,n}})},function(e,t,n){var a=n(3),r=n(4)("iterator");e.exports=function(e){return("Array"in a?a.Array:Array.prototype[r])===e}},function(e,t,n){e.exports={}},function(e,t,n){var a=n(5)("wks"),r=n(6).Symbol;e.exports=function(e){return a[e]||(a[e]=r&&r[e]||(r||n(7))("Symbol."+e))}},function(e,t,n){var a=n(6),r="__core-js_shared__",i=a[r]||(a[r]={});e.exports=function(e){return i[e]||(i[e]={})}},function(e,t,n){var a="undefined"!=typeof self&&self.Math==Math?self:Function("return this")();e.exports=a,"number"==typeof __g&&(__g=a)},function(e,t,n){var a=0,r=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++a+r).toString(36))}},function(e,t,n){var a=n(9);e.exports=function(e,t,n){if(a(e),~n&&void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,a){return e.call(t,n,a)};case 3:return function(n,a,r){return e.call(t,n,a,r)}}return function(){return e.apply(t,arguments)}}},function(e,t,n){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,n){function a(e,t){return function(){return e.apply(t,arguments)}}function r(e,t,n){var h,u,d,f,v=e&r.G,p=e&r.P,g=v?i:e&r.S?i[t]||(i[t]={}):(i[t]||{})[c],y=v?s:s[t]||(s[t]={});v&&(n=t);for(h in n)u=!(e&r.F)&&g&&h in g,d=(u?g:n)[h],f=e&r.B&&u?a(d,i):p&&"function"==typeof d?a(Function.call,d):d,g&&!u&&l(g,h,d),y[h]!=d&&o(y,h,f),p&&((y[c]||(y[c]={}))[h]=d)}var i=n(6),s=n(11),o=n(12),l=n(16),c="prototype";i.core=s,r.F=1,r.G=2,r.S=4,r.P=8,r.B=16,r.W=32,e.exports=r},function(e,t,n){var a=e.exports={};"number"==typeof __e&&(__e=a)},function(e,t,n){var a=n(13),r=n(14);e.exports=n(15)?function(e,t,n){return a.setDesc(e,t,r(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){var a=Object;e.exports={create:a.create,getProto:a.getPrototypeOf,isEnum:{}.propertyIsEnumerable,getDesc:a.getOwnPropertyDescriptor,setDesc:a.defineProperty,setDescs:a.defineProperties,getKeys:a.keys,getNames:a.getOwnPropertyNames,getSymbols:a.getOwnPropertySymbols,each:[].forEach}},function(e,t,n){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,n){e.exports=!!function(){try{return 2==Object.defineProperty({},"a",{get:function(){return 2}}).a}catch(e){}}()},function(e,t,n){function a(e,t,n,a){if("function"==typeof n){var i=e[t];s(n,l,i?String(i):o.replace(/hasOwnProperty/,String(t))),"name"in n||(n.name=t)}e===r?e[t]=n:(a||delete e[t],s(e,t,n))}var r=n(6),i=n(17),s=n(12),o=String({}.hasOwnProperty),l=n(7)("src"),c=Function.toString;a(Function.prototype,"toString",function(){return i(this,l)?this[l]:c.call(this)}),n(11).inspectSource=function(e){return c.call(e)},e.exports=a},function(e,t,n){var a={}.hasOwnProperty;e.exports=function(e,t){return a.call(e,t)}},function(e,t,n){var a=n(19),r=n(21);e.exports=function(e,t){return(t?Object:a)(r(e))}},function(e,t,n){var a=n(20),r=Object;e.exports=0 in r("z")?r:function(e){return"String"==a(e)?e.split(""):r(e)}},function(e,t,n){var a={}.toString;e.exports=function(e){return a.call(e).slice(8,-1)}},function(e,t,n){e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,n){function a(e){var t=e["return"];void 0!==t&&r(t.call(e))}var r=n(23);e.exports=function(e,t,n,i){try{return i?t(r(n)[0],n[1]):t(n)}catch(s){throw a(e),s}}},function(e,t,n){var a=n(24);e.exports=function(e){if(!a(e))throw TypeError(e+" is not an object!");return e}},function(e,t,n){e.exports=function(e){return null!==e&&("object"==typeof e||"function"==typeof e)}},function(e,t,n){var a=n(26),r=Math.min;e.exports=function(e){return e>0?r(a(e),9007199254740991):0}},function(e,t,n){var a=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:a)(e)}},function(e,t,n){var a=n(6),r=n(28),i=n(4)("iterator"),s=n(3);e.exports=n(11).getIteratorMethod=function(e){var t=a.Symbol;return void 0!=e?e[t&&t.iterator||"@@iterator"]||e[i]||s[r(e)]:void 0}},function(e,t,n){var a=n(20),r=n(4)("toStringTag"),i="Arguments"==a(function(){return arguments}());e.exports=function(e){var t,n,s;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=(t=Object(e))[r])?n:i?a(t):"Object"==(s=a(t))&&"function"==typeof t.callee?"Arguments":s}},function(e,t,n){var a=n(4)("iterator"),r=!1;try{var i=[7][a]();i["return"]=function(){r=!0},Array.from(i,function(){throw 2})}catch(s){}e.exports=function(e){if(!r)return!1;var t=!1;try{var n=[7],i=n[a]();i.next=function(){t=!0},n[a]=function(){return i},e(n)}catch(s){}return t}},function(e,t,n){var a=n(31),r=n(32),i=n(3),s=n(18);n(33)(Array,"Array",function(e,t){this._t=s(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,r(1)):"keys"==t?r(0,n):"values"==t?r(0,e[n]):r(0,[n,e[n]])},"values"),i.Arguments=i.Array,a("keys"),a("values"),a("entries")},function(e,t,n){var a=n(4)("unscopables");a in[]||n(12)(Array.prototype,a,{}),e.exports=function(e){[][a][e]=!0}},function(e,t,n){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,n){function a(){return this}var r=n(34),i=n(10),s=n(16),o=n(12),l=n(17),c=n(4)("iterator"),h=n(3),u="@@iterator",d="keys",f="values";e.exports=function(e,t,v,p,g,y,m){function b(e){switch(e){case d:return function(){return new v(this,e)};case f:return function(){return new v(this,e)}}return function(){return new v(this,e)}}n(35)(v,t,p);var x,w,k=t+" Iterator",S=e.prototype,C=S[c]||S[u]||g&&S[g],L=C||b(g);if(C){var T=n(13).getProto(L.call(new e));n(36)(T,k,!0),!r&&l(S,u)&&o(T,c,a)}if((!r||m)&&o(S,c,L),h[t]=L,h[k]=a,g)if(x={keys:y?L:b(d),values:g==f?L:b(f),entries:g!=f?L:b("entries")},m)for(w in x)w in S||s(S,w,x[w]);else i(i.P+i.F*n(37),t,x)}},function(e,t,n){e.exports=!1},function(e,t,n){var a=n(13),r={};n(12)(r,n(4)("iterator"),function(){return this}),e.exports=function(e,t,i){e.prototype=a.create(r,{next:n(14)(1,i)}),n(36)(e,t+" Iterator")}},function(e,t,n){var a=n(17),r=n(12),i=n(4)("toStringTag");e.exports=function(e,t,n){e&&!a(e=n?e:e.prototype,i)&&r(e,i,t)}},function(e,t,n){e.exports="keys"in[]&&!("next"in[].keys())},function(e,t,n){function a(e){var t=A[e]=M(_.prototype);return t._k=e,v&&R&&I(z,e,{configurable:!0,set:function(t){f(this,N)&&f(this[N],e)&&(this[N][e]=!1),I(this,e,T(1,t))}}),t}function r(e,t,n){return n&&f(A,t)?(n.enumerable?(f(e,N)&&e[N][t]&&(e[N][t]=!1),n=M(n,{enumerable:T(0,!1)})):(f(e,N)||P(e,N,T(1,{})),e[N][t]=!0),I(e,t,n)):P(e,t,n)}function i(e,t){C(e);for(var n,a=S(t=L(t)),i=0,s=a.length;s>i;)r(e,n=a[i++],t[n]);return e}function s(e,t){return void 0===t?M(e):i(M(e),t)}function o(e){var t=j.call(this,e);return t||!f(this,e)||!f(A,e)||f(this,N)&&this[N][e]?t:!0}function l(e,t){var n=E(e=L(e),t);return!n||!f(A,t)||f(e,N)&&e[N][t]||(n.enumerable=!0),n}function c(e){for(var t,n=O(L(e)),a=[],r=0;n.length>r;)f(A,t=n[r++])||t==N||a.push(t);return a}function h(e){for(var t,n=O(L(e)),a=[],r=0;n.length>r;)f(A,t=n[r++])&&a.push(A[t]);return a}var u=n(13),d=n(6),f=n(17),v=n(15),p=n(10),g=n(16),y=n(5),m=n(36),b=n(7),x=n(4),w=n(39),k=n(40),S=n(41),C=n(23),L=n(18),T=n(14),E=u.getDesc,P=u.setDesc,M=u.create,O=k.get,_=d.Symbol,R=!1,N=x("_hidden"),j=u.isEnum,F=y("symbol-registry"),A=y("symbols"),B="function"==typeof _,z=Object.prototype,I=v?function(){try{return M(P({},N,{get:function(){return P(this,N,{value:!1})[N]}}))[N]||P}catch(e){return function(e,t,n){var a=E(z,t);a&&delete z[t],P(e,t,n),a&&e!==z&&P(z,t,a)}}}():P;B||(_=function(){if(this instanceof _)throw TypeError("Symbol is not a constructor");return a(b(arguments[0]))},g(_.prototype,"toString",function(){return this._k}),u.create=s,u.isEnum=o,u.getDesc=l,u.setDesc=r,u.setDescs=i,u.getNames=k.get=c,u.getSymbols=h,v&&!n(34)&&g(z,"propertyIsEnumerable",o,!0));var U={"for":function(e){return f(F,e+="")?F[e]:F[e]=_(e)},keyFor:function(e){return w(F,e)},useSetter:function(){R=!0},useSimple:function(){R=!1}};u.each.call("hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),function(e){var t=x(e);U[e]=B?t:a(t)}),R=!0,p(p.G+p.W,{Symbol:_}),p(p.S,"Symbol",U),p(p.S+p.F*!B,"Object",{create:s,defineProperty:r,defineProperties:i,getOwnPropertyDescriptor:l,getOwnPropertyNames:c,getOwnPropertySymbols:h}),m(_,"Symbol"),m(Math,"Math",!0),m(d.JSON,"JSON",!0)},function(e,t,n){var a=n(13),r=n(18);e.exports=function(e,t){for(var n,i=r(e),s=a.getKeys(i),o=s.length,l=0;o>l;)if(i[n=s[l++]]===t)return n}},function(e,t,n){function a(e){try{return s(e)}catch(t){return o.slice()}}var r={}.toString,i=n(18),s=n(13).getNames,o="object"==typeof window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.get=function(e){return o&&"[object Window]"==r.call(e)?a(e):s(i(e))}},function(e,t,n){var a=n(13);e.exports=function(e){var t=a.getKeys(e),n=a.isEnum,r=a.getSymbols;if(r)for(var i,s=r(e),o=0;s.length>o;)n.call(e,i=s[o++])&&t.push(i);return t}},function(e,t,n){var a=n(43)(!0);n(33)(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=a(t,n),this._i+=e.length,{value:e,done:!1})})},function(e,t,n){var a=n(26),r=n(21);e.exports=function(e){return function(t,n){var i,s,o=String(r(t)),l=a(n),c=o.length;return 0>l||l>=c?e?"":void 0:(i=o.charCodeAt(l),55296>i||i>56319||l+1===c||(s=o.charCodeAt(l+1))<56320||s>57343?e?o.charAt(l):i:e?o.slice(l,l+2):(i-55296<<10)+(s-56320)+65536)}}}])},function(e,t,n){"use strict";!function(t,a){e.exports=a(n(2))}(void 0,function(e){return function(e){function t(a){if(n[a])return n[a].exports;var r=n[a]={exports:{},id:a,loaded:!1};return e[a].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){function a(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e){e(this,"createTree",function(e,t){var n=e.apply(void 0,a(t)),r=s(t,2),i=r[1],o=void 0===i?{}:i;if(o.history||"undefined"==typeof o.history){var l=o.history&&"undefined"!=typeof o.history.collapsed;n.historySnapshots=[],n.history=new g(n,l?o.history.collapsed:!0)}return n}),e(l.Tree,"resizeToContainer",function(e){return this.history?void this.history.resizeTree():e.apply(this)}),this.History=g}Object.defineProperty(t,"__esModule",{
value:!0});var s=function(){function e(e,t){var n=[],a=!0,r=!1,i=void 0;try{for(var s,o=e[Symbol.iterator]();!(a=(s=o.next()).done)&&(n.push(s.value),!t||n.length!==t);a=!0);}catch(l){r=!0,i=l}finally{try{!a&&o["return"]&&o["return"]()}finally{if(r)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();t["default"]=i;var l=n(1),c=n(2),h=c.dom.addClass,u=c.dom.hasClass,d=c.dom.removeClass,f=c.events.fireEvent,v=c.events.addEvent,p=c.events.killEvent,g=function(){function e(t,n){r(this,e),this.tree=t,this.injectCss(),this.div=this.createDiv(t.canvasEl),this.tree.addListener("subtree",function(e){this.addSnapshot(e.node)}.bind(this)),this.tree.addListener("loaded",this.reset.bind(this)),this.tree.addListener("typechanged",function(){this.addSnapshot(this.tree.root.id)}.bind(this)),n?this.collapse():this.expand()}return o(e,[{key:"reset",value:function(){this.clear(),this.tree.drawn&&this.addSnapshot(this.tree.root.id)}},{key:"collapse",value:function(){h(this.div,"collapsed"),this.toggleDiv.firstChild.data=">",this.resizeTree(),this.tree.draw()}},{key:"expand",value:function(){d(this.div,"collapsed"),this.toggleDiv.firstChild.data="<",this.resizeTree(),this.tree.draw()}},{key:"isCollapsed",value:function(){return u(this.div,"collapsed")}},{key:"toggle",value:function(){this.isCollapsed()?this.expand():this.collapse(),f(this.tree.canvasEl,"historytoggle",{isOpen:!this.isCollapsed()})}},{key:"createDiv",value:function(e){var t=document.createElement("div");t.className="pc-history",v(t,"click",p),v(t,"contextmenu",p);var n=document.createElement("div");n.innerHTML="History",n.className="pc-history-title",t.appendChild(n);var a=document.createElement("div");a.appendChild(document.createTextNode("<")),a.className="toggle",v(a,"click",this.toggle.bind(this)),t.appendChild(a),this.toggleDiv=a;var r=document.createElement("ul");return r.className="pc-history-snapshots",t.appendChild(r),this.snapshotList=r,e.appendChild(t),t}},{key:"resizeTree",value:function(){var e=this.tree;this.width=this.div.offsetWidth,e.setSize(e.canvasEl.offsetWidth-this.width,e.canvasEl.offsetHeight),this.isCollapsed()?e.canvasEl.getElementsByTagName("canvas")[0].style.marginLeft=this.width+"px":e.canvasEl.getElementsByTagName("canvas")[0].style.marginLeft="20%"}},{key:"addSnapshot",value:function(e){var t="phylocanvas-history-",n=this.tree.treeType,a=!1;if(this.tree.historySnapshots.forEach(function(r){r.style.background="transparent",r.id===t+e&&r.getAttribute("data-tree-type")===n&&(a=!0,r.style.background="lightblue")}),!a){var r=this.tree.getPngUrl(),i=document.createElement("li"),s=document.createElement("img");s.width=this.width,s.src=r,s.id=t+e,s.setAttribute("data-tree-type",this.tree.treeType),s.style.background="lightblue",this.tree.historySnapshots.push(s),i.appendChild(s),this.snapshotList.appendChild(i),v(s,"click",this.goBackTo.bind(this))}}},{key:"clear",value:function(){for(var e=this.snapshotList.getElementsByTagName("li"),t=e.length;t--;)this.snapshotList.removeChild(e[0])}},{key:"goBackTo",value:function(e){var t=e.target;this.tree.setTreeType(t.getAttribute("data-tree-type"),!0),this.tree.redrawFromBranch(this.tree.originalTree.branches[t.id.replace("phylocanvas-history-","")])}},{key:"injectCss",value:function(){var e=".pc-history { position: absolute; top: 0; bottom: 0; left: 0; box-sizing: border-box; width: 20%; overflow: hidden; background: #EEE }.pc-history .pc-history-title { box-sizing: border-box; height: 20px; text-align: center; font-size: 13px; color: #666; padding: 2px; border-bottom: 1px solid #bbb }.pc-history .toggle { position: absolute; top: 0; right: 0; padding: 2px 8px; cursor: pointer; border-top-left-radius: 50%; border-bottom-left-radius: 50%; background-color: #666; color: #FFF; box-sizing: border-box; height: 20px; }.pc-history.collapsed .toggle { border-radius: 0 50% 50% 0 }.pc-history .toggle:hover { background-color: #FFF; color: #CCC }.pc-history.collapsed { width: 25px }.pc-history.collapsed .pc-history-snapshots { display: none }.pc-history.collapsed .pc-history-title { writing-mode: tb-rl; -webkit-transform: rotate(270deg); -moz-transform: rotate(270deg); -o-transform: rotate(270deg); -ms-transform: rotate(270deg); transform: rotate(270deg); margin-top: 70px; background: 0 0; color: #666; letter-spacing: 1.2px; border-bottom: none }.pc-history-snapshots { position: absolute; top: 20px; bottom: 0; margin: 0; padding: 0; overflow-x: hidden; overflow-y: scroll; }.pc-history-snapshots li { list-style: outside none none }.pc-history img { border: 0px solid #CCC; border-top-width: 1px; cursor: pointer; width: 100%; box-sizing: border-box; transition: background-color .25s ease; display: block }.pc-history img:hover { background-color: #fff }",t=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e)),t.appendChild(n)}}]),e}();e.exports=t["default"]},function(t,n){t.exports=e},function(e,t,n){function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),i=a(r),s=n(6),o=a(s),l=n(4),c=a(l),h=n(5),u=a(h);t["default"]={canvas:i,constants:o,dom:c,events:u},e.exports=t["default"]},function(e,t,n){function a(e){return e.backingStorePixelRatio||e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||1}function r(e){return(window.devicePixelRatio||1)/a(e)}function i(e){return e=e-l.getX(this.canvas.canvas)+window.pageXOffset,e*=r(this.canvas),e-=this.canvas.canvas.width/2,e-=this.offsetx,e/=this.zoom}function s(e){return e=e-l.getY(this.canvas.canvas)+window.pageYOffset,e*=r(this.canvas),e-=this.canvas.canvas.height/2,e-=this.offsety,e/=this.zoom}function o(e,t,n){return[i.call(n,e),s.call(n,t)]}Object.defineProperty(t,"__esModule",{value:!0}),t.getBackingStorePixelRatio=a,t.getPixelRatio=r,t.translateClick=o;var l=n(4)},function(e,t,n){function a(e){var t=new Blob([e],{type:"text/csv;charset=utf-8"});return u.createObjectURL(t)}function r(e,t){var n=document.createElement("a"),a="undefined"!=typeof n.download;n.href=e,n.target="_blank",a&&(n.download=t),h.fireEvent(n,"click"),a&&u.revokeObjectURL(n.href)}function i(e){for(var t=0;e;)t+=e.offsetLeft,e=e.offsetParent;return t}function s(e){for(var t=0;e;)t+=e.offsetTop,e=e.offsetParent;return t}function o(e,t){var n=e.className.split(" ");-1===n.indexOf(t)&&(n.push(t),e.className=n.join(" "))}function l(e,t){var n=e.className.split(" "),a=n.indexOf(t);-1!==a&&(n.splice(a,1),e.className=n.join(" "))}function c(e,t){var n=e.className.split(" "),a=n.indexOf(t);return-1!==a}Object.defineProperty(t,"__esModule",{value:!0}),t.createBlobUrl=a,t.setupDownloadLink=r,t.getX=i,t.getY=s,t.addClass=o,t.removeClass=l,t.hasClass=c;var h=n(5),u=window.URL||window.webkitURL},function(e,t){function n(e){return e.preventDefault(),!1}function a(e,t){var n,a,r=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];document.createEvent?(n=document.createEvent("HTMLEvents"),n.initEvent(t,!0,!0)):(n=document.createEventObject(),n.eventType=t),n.eventName=t;for(a in r)r.hasOwnProperty(a)&&(n[a]=r[a]);document.createEvent?e.dispatchEvent(n):e.fireEvent("on"+n.eventType,n)}function r(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent("on"+t,function(){return n.call(e,window.event)})}function i(e){e.stopPropagation(),e.preventDefault()}function s(e,t){var n;return n="string"==typeof t?function(n){return e[t]?e[t](n):void 0}:function(){return t(e)}}Object.defineProperty(t,"__esModule",{value:!0}),t.preventDefault=n,t.fireEvent=a,t.addEvent=r,t.killEvent=i,t.createHandler=s},function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n={FORTYFIVE:Math.PI/4,QUARTER:Math.PI/2,HALF:Math.PI,FULL:2*Math.PI};t.Angles=n;var a={x:"star",s:"square",o:"circle",t:"triangle"};t.Shapes=a}])})},function(e,t,n){"use strict";!function(t,a){e.exports=a(n(2))}(void 0,function(e){return function(e){function t(a){if(n[a])return n[a].exports;var r=n[a]={exports:{},id:a,loaded:!1};return e[a].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){function a(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function i(e){e(o["default"],"createTree",function(e,t){var n=e.apply(void 0,r(t));return n.showMetadata=!1,n.selectedMetadataColumns=[],n.metadataXStep=15,n.metadataHeadingDrawn=!1,n}),e(s.Tree,"draw",function(e,t){e.apply(this,t),this.metadataHeadingDrawn=!1}),e(s.Branch,"drawLeaf",function(e){e.call(this),this.tree.showMetadata&&this.drawMetadata()}),e(s.Branch,"getTotalSize",function(e){var t=e.call(this);return this.tree.showMetadata&&(t+=this.tree.getMetadataColumnHeadings().length*this.tree.metadataXStep),t})}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=i;var s=n(1),o=a(s);s.Tree.prototype.viewMetadataColumns=function(){var e=arguments.length<=0||void 0===arguments[0]?this.getMetadataColumnHeadings():arguments[0];this.showMetadata=!0,this.selectedMetadataColumns=e,this.fitInPanel(),this.draw()},s.Tree.prototype.getMetadataColumnHeadings=function(){for(var e=[],t=0;t<this.leaves.length;t++)if(Object.keys(this.leaves[t].data).length>0){e=Object.keys(this.leaves[t].data);break}return e},s.Tree.prototype.clearMetadata=function(){for(var e=0;e<this.leaves.length;e++)Object.keys(this.leaves[e].data).length>0&&(this.leaves[e].data={})},s.Branch.prototype.drawMetadata=function(){var e=0;(this.tree.showLabels||this.tree.hoverLabel&&this.highlighted)&&(e=this.tree.maxLabelLength[this.tree.treeType]);var t,n,a=this.getLabelStartX()+e,r=0,i=[],s=this.tree.textSize,o=this.tree.metadataXStep/2;this.tree.alignLabels&&("rectangular"===this.tree.treeType?a+=this.tree.farthestNodeFromRootX-this.centerx:"hierarchical"===this.tree.treeType&&(a+=this.tree.farthestNodeFromRootY-this.centery)),!this.tree.metadataHeadingDrawn&&this.tree.alignLabels&&"circular"!==this.tree.treeType&&"radial"!==this.tree.treeType&&(this.drawMetadataHeading(a,r),this.tree.metadataHeadingDrawn=!0);var l=this.tree.metadataXStep;if(Object.keys(this.data).length>0){for(this.canvas.beginPath(),i=this.tree.selectedMetadataColumns.length>0?this.tree.selectedMetadataColumns:Object.keys(this.data),r-=s/2,t=0;t<i.length;t++)n=i[t],a+=l,window.parseInt(this.data[n])?(this.canvas.fillStyle=this.tree.colour1,this.canvas.fillRect(a,r,o,s)):0===window.parseInt(this.data[n])&&(this.canvas.fillStyle=this.tree.colour0,this.canvas.fillRect(a,r,o,s));this.canvas.stroke(),this.canvas.closePath()}},s.Branch.prototype.drawMetadataHeading=function(e,t){var n,a,r;for(n=this.tree.selectedMetadataColumns.length>0?this.tree.selectedMetadataColumns:Object.keys(this.data),this.canvas.font="12px Sans-serif",this.canvas.fillStyle="black",r=0;r<n.length;r++)a=n[r],e+=this.tree.metadataXStep,this.canvas.rotate(-Math.PI/2),"rectangular"===this.tree.treeType?(this.canvas.textAlign="left",this.canvas.fillText(a,20,e+6)):"hierarchical"===this.tree.treeType?(this.canvas.textAlign="right",this.canvas.fillText(a,-20,e+8)):"diagonal"===this.tree.treeType&&(this.canvas.textAlign="left",this.canvas.fillText(a,20,e+6)),this.canvas.rotate(Math.PI/2)},e.exports=t["default"]},function(t,n){t.exports=e}])})},function(e,t,n){"use strict";!function(t,a){e.exports=a(n(2))}(void 0,function(e){return function(e){function t(a){if(n[a])return n[a].exports;var r=n[a]={exports:{},id:a,loaded:!1};return e[a].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){function a(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e,t){var n=t.text,a=void 0===n?"link":n,r=t.filename,i=void 0===r?"file":r,s=t.href,o=document.createElement("a");return o.appendChild(document.createTextNode(a)),o.href=s,o.download=i,o}function o(e){return s(e,{text:this.text,filename:"phylocanvas_tree.png",href:e.tree.getPngUrl()})}function l(e){var t=e.tree.root.downloadLeafIdsFromBranch();return s(e,{text:this.text,filename:"pc-leaf-ids-root.txt",href:t})}function c(e,t){var n=t.downloadLeafIdsFromBranch();return s(e,{text:this.text,filename:"pc-leaf-ids-"+t.id+".txt",href:n})}function h(e,t){return t?t.leaf&&!e.node?!0:!t.leaf&&e.node?!0:!1:!e.node}function u(e){if(2===e.button){var t;e.preventDefault();var n=(t=this.root).clicked.apply(t,a(x(e.clientX,e.clientY,this)));this.contextMenu.open(e.clientX,e.clientY,n&&n.interactive?n:null),this.contextMenu.closed=!1,this.tooltip.close()}}function d(e){e(this,"createTree",function(e,t){var n=e.apply(void 0,a(t)),r=f(t,2),i=r[1],s=void 0===i?{}:i;return n.contextMenu=new k(n,s.contextMenu),n.addListener("contextmenu",u.bind(n)),n}),this.ContextMenu=k}Object.defineProperty(t,"__esModule",{value:!0});var f=function(){function e(e,t){var n=[],a=!0,r=!1,i=void 0;try{for(var s,o=e[Symbol.iterator]();!(a=(s=o.next()).done)&&(n.push(s.value),!t||n.length!==t);a=!0);}catch(l){r=!0,i=l}finally{try{!a&&o["return"]&&o["return"]()}finally{if(r)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),v=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),p=function(e,t,n){for(var a=!0;a;){var r=e,i=t,s=n;o=c=l=void 0,a=!1,null===r&&(r=Function.prototype);var o=Object.getOwnPropertyDescriptor(r,i);if(void 0!==o){if("value"in o)return o.value;var l=o.get;return void 0===l?void 0:l.call(s)}var c=Object.getPrototypeOf(r);if(null===c)return void 0;e=c,t=i,n=s,a=!0}};t["default"]=d;var g=n(1),y=n(2),m=y.events.createHandler,b=y.events.preventDefault,x=y.canvas.translateClick,w=[[{text:"Collapse/Expand Branch",node:!0,handler:function(e){e.toggleCollapsed(),e.tree.draw()}},{text:"Rotate Branch",node:!0,handler:"rotate"},{text:"Show/Hide Labels",handler:"toggleLabels"}],[{text:"Redraw Subtree",node:!0,handler:"redrawTreeFromBranch"},{text:"Redraw Original Tree",handler:"redrawOriginalTree"}],[{text:"Export Leaf IDs on Branch",node:!0,element:c},{text:"Export As Image",element:o},{text:"Export Leaf IDs",element:l}]],k=function(e){function t(e){var a=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],i=a.menuItems,s=void 0===i?w:i,o=a.unstyled,l=void 0===o?!1:o,c=a.className;r(this,t),p(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,{className:("phylocanvas-context-menu "+(c?c:"")).trim(),element:document.createElement("ul")}),this.menuItems=s,l||n(3),this.element.addEventListener("click",function(e){e.stopPropagation()})}return i(t,e),v(t,[{key:"createSublist",value:function(e,t){var n=document.createElement("ul"),a=!0,r=!1,i=void 0;try{for(var s,o=e[Symbol.iterator]();!(a=(s=o.next()).done);a=!0){var l=s.value;if(h(l,t)){var c=document.createElement("li");l.element?c.appendChild(l.element(this,t)):(c.appendChild(document.createTextNode(l.text)),c.addEventListener("click",m(l.node?t:this.tree,l.handler))),c.addEventListener("click",m(this,"close")),c.addEventListener("contextmenu",b),n.appendChild(c)}}}catch(u){r=!0,i=u}finally{try{!a&&o["return"]&&o["return"]()}finally{if(r)throw i}}n.hasChildNodes()&&this.element.appendChild(n)}},{key:"createContent",value:function(e){var t=!0,n=!1,a=void 0;try{for(var r,i=this.menuItems[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){var s=r.value;this.createSublist(s,e)}}catch(o){n=!0,a=o}finally{try{!t&&i["return"]&&i["return"]()}finally{if(n)throw a}}document.body.addEventListener("click",m(this,"close"))}}]),t}(g.Tooltip);e.exports=t["default"]},function(t,n){t.exports=e},function(e,t,n){!function(t,n){e.exports=n()}(void 0,function(){return function(e){function t(a){if(n[a])return n[a].exports;var r=n[a]={exports:{},id:a,loaded:!1};return e[a].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=a(r),s=n(4),o=a(s),l=n(2),c=a(l),h=n(3),u=a(h);t["default"]={canvas:i,constants:o,dom:c,events:u},e.exports=t["default"]},function(e,t,n){function a(e){return e.backingStorePixelRatio||e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||1}function r(e){return(window.devicePixelRatio||1)/a(e)}function i(e){return e=e-l.getX(this.canvas.canvas)+window.pageXOffset,e*=r(this.canvas),e-=this.canvas.canvas.width/2,e-=this.offsetx,e/=this.zoom}function s(e){return e=e-l.getY(this.canvas.canvas)+window.pageYOffset,e*=r(this.canvas),e-=this.canvas.canvas.height/2,e-=this.offsety,e/=this.zoom}function o(e,t,n){return[i.call(n,e),s.call(n,t)]}Object.defineProperty(t,"__esModule",{value:!0}),t.getBackingStorePixelRatio=a,t.getPixelRatio=r,t.translateClick=o;var l=n(2)},function(e,t,n){function a(e){var t=new Blob([e],{type:"text/csv;charset=utf-8"});return u.createObjectURL(t)}function r(e,t){var n=document.createElement("a"),a="undefined"!=typeof n.download;n.href=e,n.target="_blank",a&&(n.download=t),h.fireEvent(n,"click"),a&&u.revokeObjectURL(n.href)}function i(e){for(var t=0;e;)t+=e.offsetLeft,e=e.offsetParent;return t}function s(e){for(var t=0;e;)t+=e.offsetTop,e=e.offsetParent;return t}function o(e,t){var n=e.className.split(" ");-1===n.indexOf(t)&&(n.push(t),e.className=n.join(" "))}function l(e,t){var n=e.className.split(" "),a=n.indexOf(t);-1!==a&&(n.splice(a,1),e.className=n.join(" "))}function c(e,t){var n=e.className.split(" "),a=n.indexOf(t);return-1!==a}Object.defineProperty(t,"__esModule",{value:!0}),t.createBlobUrl=a,t.setupDownloadLink=r,t.getX=i,t.getY=s,t.addClass=o,t.removeClass=l,t.hasClass=c;var h=n(3),u=window.URL||window.webkitURL},function(e,t){function n(e){return e.preventDefault(),!1}function a(e,t){var n,a,r=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];document.createEvent?(n=document.createEvent("HTMLEvents"),n.initEvent(t,!0,!0)):(n=document.createEventObject(),n.eventType=t),n.eventName=t;for(a in r)r.hasOwnProperty(a)&&(n[a]=r[a]);document.createEvent?e.dispatchEvent(n):e.fireEvent("on"+n.eventType,n)}function r(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent("on"+t,function(){return n.call(e,window.event)})}function i(e){e.stopPropagation(),e.preventDefault()}function s(e,t){var n;return n="string"==typeof t?function(n){return e[t]?e[t](n):void 0}:function(){return t(e)}}Object.defineProperty(t,"__esModule",{value:!0}),t.preventDefault=n,t.fireEvent=a,t.addEvent=r,t.killEvent=i,t.createHandler=s},function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n={FORTYFIVE:Math.PI/4,QUARTER:Math.PI/2,HALF:Math.PI,FULL:2*Math.PI};t.Angles=n;var a={x:"star",s:"square",o:"circle",t:"triangle"};t.Shapes=a}])})},function(e,t,n){var a=n(4);"string"==typeof a&&(a=[[e.id,a,""]]),n(6)(a,{}),a.locals&&(e.exports=a.locals)},function(e,t,n){t=e.exports=n(5)(),t.push([e.id,".phylocanvas-context-menu,.phylocanvas-context-menu ul{list-style:outside none none;margin:0}.phylocanvas-context-menu{background:#fff;border-radius:2px;box-shadow:0 2px 2px 0 rgba(0,0,0,.14),0 3px 1px -2px rgba(0,0,0,.2),0 1px 5px 0 rgba(0,0,0,.12);letter-spacing:0;list-style:outside none none;min-width:124px;padding:8px 0}.phylocanvas-context-menu ul{padding:0}.phylocanvas-context-menu ul+ul{border-top:1px solid #e0e0e0;margin-top:8px;padding-top:8px}.phylocanvas-context-menu li{padding:0 16px;outline-color:#bdbdbd;height:40px;line-height:40px;text-decoration:none;background-color:transparent;cursor:pointer;font-size:13px;font-family:Helvetica,Arial,sans-serif}.phylocanvas-context-menu li:focus,.phylocanvas-context-menu li:hover{background-color:#eee}.phylocanvas-context-menu a{display:block;margin:0 -16px;padding:0 16px}.phylocanvas-context-menu a,.phylocanvas-context-menu li{color:rgba(0,0,0,.87);text-decoration:none}",""])},function(e,t){e.exports=function(){var e=[];return e.toString=function(){for(var e=[],t=0;t<this.length;t++){var n=this[t];n[2]?e.push("@media "+n[2]+"{"+n[1]+"}"):e.push(n[1])}return e.join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var a={},r=0;r<this.length;r++){var i=this[r][0];"number"==typeof i&&(a[i]=!0)}for(r=0;r<t.length;r++){var s=t[r];"number"==typeof s[0]&&a[s[0]]||(n&&!s[2]?s[2]=n:n&&(s[2]="("+s[2]+") and ("+n+")"),e.push(s))}},e}},function(e,t,n){function a(e,t){for(var n=0;n<e.length;n++){var a=e[n],r=u[a.id];if(r){r.refs++;for(var i=0;i<r.parts.length;i++)r.parts[i](a.parts[i]);for(;i<a.parts.length;i++)r.parts.push(o(a.parts[i],t))}else{for(var s=[],i=0;i<a.parts.length;i++)s.push(o(a.parts[i],t));u[a.id]={id:a.id,refs:1,parts:s}}}}function r(e){for(var t=[],n={},a=0;a<e.length;a++){var r=e[a],i=r[0],s=r[1],o=r[2],l=r[3],c={css:s,media:o,sourceMap:l};n[i]?n[i].parts.push(c):t.push(n[i]={id:i,parts:[c]})}return t}function i(){var e=document.createElement("style"),t=v();return e.type="text/css",t.appendChild(e),e}function s(){var e=document.createElement("link"),t=v();return e.rel="stylesheet",t.appendChild(e),e}function o(e,t){var n,a,r;if(t.singleton){var o=g++;n=p||(p=i()),a=l.bind(null,n,o,!1),r=l.bind(null,n,o,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=s(),a=h.bind(null,n),r=function(){n.parentNode.removeChild(n),n.href&&URL.revokeObjectURL(n.href)}):(n=i(),a=c.bind(null,n),r=function(){n.parentNode.removeChild(n)});return a(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;a(e=t)}else r()}}function l(e,t,n,a){var r=n?"":a.css;if(e.styleSheet)e.styleSheet.cssText=y(t,r);else{var i=document.createTextNode(r),s=e.childNodes;s[t]&&e.removeChild(s[t]),s.length?e.insertBefore(i,s[t]):e.appendChild(i)}}function c(e,t){var n=t.css,a=t.media;if(t.sourceMap,a&&e.setAttribute("media",a),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}function h(e,t){var n=t.css,a=(t.media,t.sourceMap);a&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(a))))+" */");var r=new Blob([n],{type:"text/css"}),i=e.href;e.href=URL.createObjectURL(r),i&&URL.revokeObjectURL(i)}var u={},d=function(e){var t;return function(){return"undefined"==typeof t&&(t=e.apply(this,arguments)),t}},f=d(function(){return/msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())}),v=d(function(){return document.head||document.getElementsByTagName("head")[0]}),p=null,g=0;e.exports=function(e,t){t=t||{},"undefined"==typeof t.singleton&&(t.singleton=f());var n=r(e);return a(n,t),function(e){for(var i=[],s=0;s<n.length;s++){var o=n[s],l=u[o.id];l.refs--,i.push(l)}if(e){var c=r(e);a(c,t)}for(var s=0;s<i.length;s++){var l=i[s];if(0===l.refs){for(var h=0;h<l.parts.length;h++)l.parts[h]();delete u[l.id]}}}};var y=function(){var e=[];return function(t,n){return e[t]=n,e.filter(Boolean).join("\n")}}()}])})}])});